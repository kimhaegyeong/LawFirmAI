# LawFirmAI - Cursor Development Rules

## í”„ë¡œì íŠ¸ ê°œìš”
- **í”„ë¡œì íŠ¸ëª…**: LawFirmAI (ë²•ë¥  AI ì–´ì‹œìŠ¤í„´íŠ¸)
- **ëª©í‘œ**: HuggingFace Spaces ë°°í¬ë¥¼ ìœ„í•œ ë²•ë¥  AI ì‹œìŠ¤í…œ ê°œë°œ
- **ê¸°ìˆ  ìŠ¤íƒ**: FastAPI + React + KoBART/KoGPT-2 + FAISS + SQLite

## í”„ë¡œì íŠ¸ êµ¬ì¡° ê·œì¹™

### ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
LawFirmAI/
â”œâ”€â”€ frontend/               # React í”„ë¡ íŠ¸ì—”ë“œ
â”‚   â”œâ”€â”€ src/                # React ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”œâ”€â”€ package.json        # npm ì˜ì¡´ì„±
â”‚   â”œâ”€â”€ vite.config.ts      # Vite ì„¤ì •
â”‚   â”œâ”€â”€ Dockerfile          # React Docker ì„¤ì •
â”‚   â””â”€â”€ docker-compose.yml  # React ë¡œì»¬ ê°œë°œ í™˜ê²½
â”œâ”€â”€ api/                    # FastAPI ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â”œâ”€â”€ main.py            # FastAPI ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â”œâ”€â”€ requirements.txt   # FastAPI ì˜ì¡´ì„±
â”‚   â”œâ”€â”€ Dockerfile        # FastAPI Docker ì„¤ì •
â”‚   â””â”€â”€ docker-compose.yml # FastAPI ë¡œì»¬ ê°œë°œ í™˜ê²½
â”œâ”€â”€ source/                 # Core Modules (ê³µí†µ ì†ŒìŠ¤ ì½”ë“œ)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ models/            # AI ëª¨ë¸ ê´€ë ¨
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ kobart_model.py
â”‚   â”‚   â”œâ”€â”€ sentence_bert.py
â”‚   â”‚   â””â”€â”€ model_manager.py
â”‚   â”œâ”€â”€ services/          # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ chat_service.py
â”‚   â”‚   â”œâ”€â”€ rag_service.py
â”‚   â”‚   â”œâ”€â”€ search_service.py
â”‚   â”‚   â””â”€â”€ analysis_service.py
â”‚   â”œâ”€â”€ data/              # ë°ì´í„° ì²˜ë¦¬
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ database.py
â”‚   â”‚   â”œâ”€â”€ vector_store.py
â”‚   â”‚   â””â”€â”€ data_processor.py
â”‚   â”œâ”€â”€ api/               # API ê´€ë ¨
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ endpoints.py
â”‚   â”‚   â”œâ”€â”€ middleware.py
â”‚   â”‚   â””â”€â”€ schemas.py
â”‚   â””â”€â”€ utils/             # ìœ í‹¸ë¦¬í‹°
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ config.py
â”‚       â”œâ”€â”€ logger.py
â”‚       â””â”€â”€ helpers.py
â”œâ”€â”€ data/                  # ë°ì´í„° íŒŒì¼
â”‚   â”œâ”€â”€ raw/               # ì›ë³¸ ë°ì´í„°
â”‚   â”œâ”€â”€ processed/         # ì „ì²˜ë¦¬ëœ ë°ì´í„°
â”‚   â””â”€â”€ embeddings/        # ë²¡í„° ì„ë² ë”©
â”œâ”€â”€ tests/                 # í…ŒìŠ¤íŠ¸ ì½”ë“œ
â”œâ”€â”€ docs/                  # ë¬¸ì„œ
â”œâ”€â”€ scripts/               # ìœ í‹¸ë¦¬í‹° ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ .env.example           # í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
â”œâ”€â”€ .gitignore             # Git ë¬´ì‹œ íŒŒì¼
â””â”€â”€ README.md              # í”„ë¡œì íŠ¸ ë¬¸ì„œ
```

## ì½”ë”© ê·œì¹™

### 0. ì½”ë“œ ìˆ˜ì • ìš°ì„  ì›ì¹™ (CRITICAL)

**ê¸°ì¡´ ì†ŒìŠ¤ì½”ë“œ ìˆ˜ì •ì„ ìµœìš°ì„ ìœ¼ë¡œ í•˜ê³ , ì‹ ê·œ íŒŒì¼ ìƒì„±ì€ ê¼­ í•„ìš”í•œ ê²½ìš°ì—ë§Œ í—ˆìš©í•©ë‹ˆë‹¤.**

#### ì›ì¹™
1. **ê¸°ì¡´ íŒŒì¼ ìˆ˜ì • ìš°ì„ **
   - ê¸°ëŠ¥ ì¶”ê°€/ìˆ˜ì • ì‹œ ê¸°ì¡´ íŒŒì¼ì„ ë¨¼ì € ê²€í† í•˜ê³  ìˆ˜ì •
   - ê¸°ì¡´ í´ë˜ìŠ¤/í•¨ìˆ˜ì— ê¸°ëŠ¥ì„ í™•ì¥í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„
   - ê¸°ì¡´ ì½”ë“œ êµ¬ì¡°ë¥¼ ìµœëŒ€í•œ ìœ ì§€í•˜ë©´ì„œ ê°œì„ 

2. **ì‹ ê·œ íŒŒì¼ ìƒì„± ì¡°ê±´**
   - ê¸°ì¡´ íŒŒì¼ ìˆ˜ì •ìœ¼ë¡œëŠ” ìš”êµ¬ì‚¬í•­ì„ ì¶©ì¡±í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ì—ë§Œ í—ˆìš©
   - ì™„ì „íˆ ìƒˆë¡œìš´ ê¸°ëŠ¥ ì˜ì—­ì´ í•„ìš”í•œ ê²½ìš°
   - ê¸°ì¡´ íŒŒì¼ì´ ì´ë¯¸ ë„ˆë¬´ í¬ê³  ë³µì¡í•˜ì—¬ ë¶„ë¦¬ê°€ í•„ìš”í•œ ê²½ìš° (1000ì¤„ ì´ìƒ)
   - ì•„í‚¤í…ì²˜ìƒ ë…ë¦½ì ì¸ ëª¨ë“ˆì´ í•„ìš”í•œ ê²½ìš°

3. **íŒŒì¼ ìƒì„± ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸**
   - [ ] ê¸°ì¡´ íŒŒì¼ì—ì„œ ìœ ì‚¬í•œ ê¸°ëŠ¥ì„ ì°¾ì•˜ëŠ”ê°€?
   - [ ] ê¸°ì¡´ í´ë˜ìŠ¤/í•¨ìˆ˜ì— ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆëŠ”ê°€?
   - [ ] ê¸°ì¡´ íŒŒì¼ì„ í™•ì¥í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆëŠ”ê°€?
   - [ ] ì‹ ê·œ íŒŒì¼ì´ ì •ë§ í•„ìš”í•œê°€? (ì•„í‚¤í…ì²˜ìƒ ë¶„ë¦¬ê°€ í•„ìš”í•œê°€?)

4. **ê¶Œì¥ ì‚¬í•­**
   ```python
   # âŒ ë‚˜ìœ ì˜ˆ: ìƒˆë¡œìš´ ê¸°ëŠ¥ë§ˆë‹¤ ìƒˆ íŒŒì¼ ìƒì„±
   # services/chat_service_v2.py
   # services/chat_service_enhanced.py
   # services/chat_service_improved.py
   
   # âœ… ì¢‹ì€ ì˜ˆ: ê¸°ì¡´ íŒŒì¼ì— ê¸°ëŠ¥ ì¶”ê°€
   # services/chat_service.pyì— ìƒˆë¡œìš´ ë©”ì„œë“œ ì¶”ê°€
   class ChatService:
       def process_message(self, message: str) -> str:
           # ê¸°ì¡´ ê¸°ëŠ¥
           pass
       
       def process_message_with_context(self, message: str, context: str) -> str:
           # ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€
           pass
   ```

5. **ì˜ˆì™¸ ì‚¬í•­**
   - í…ŒìŠ¤íŠ¸ íŒŒì¼ (`test_*.py`, `*_test.py`)ì€ ê¸°ëŠ¥ë³„ë¡œ ë¶„ë¦¬ í—ˆìš©
   - ì„¤ì • íŒŒì¼ (`config.py`, `settings.py`)ì€ í™˜ê²½ë³„ ë¶„ë¦¬ í—ˆìš©
   - ë¬¸ì„œ íŒŒì¼ (`*.md`)ì€ ì£¼ì œë³„ ë¶„ë¦¬ í—ˆìš©
   - ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” ë²„ì „ë³„ ë¶„ë¦¬ í—ˆìš©

6. **ë¦¬íŒ©í† ë§ ê°€ì´ë“œ**
   - ê¸°ì¡´ íŒŒì¼ì´ ë„ˆë¬´ ì»¤ì§„ ê²½ìš° (1000ì¤„ ì´ìƒ):
     - ë¨¼ì € ê¸°ì¡´ íŒŒì¼ ë‚´ì—ì„œ í´ë˜ìŠ¤/í•¨ìˆ˜ë¡œ ëª¨ë“ˆí™” ì‹œë„
     - ê·¸ë˜ë„ ë¶€ì¡±í•œ ê²½ìš°ì—ë§Œ íŒŒì¼ ë¶„ë¦¬ ê³ ë ¤
   - ì¤‘ë³µ ì½”ë“œ ë°œê²¬ ì‹œ:
     - ê³µí†µ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë¡œ ì¶”ì¶œí•˜ì—¬ ê¸°ì¡´ íŒŒì¼ì— ì¶”ê°€
     - ì—¬ëŸ¬ íŒŒì¼ì—ì„œ ì‚¬ìš©ë˜ëŠ” ê²½ìš°ì—ë§Œ ë³„ë„ ìœ í‹¸ë¦¬í‹° íŒŒì¼ ìƒì„±

### 0-1. ì½”ë“œ ë³€ê²½ ìµœì†Œí™” ì›ì¹™ (CRITICAL)

**ì›ë³¸ ì½”ë“œë¥¼ ìµœëŒ€í•œ ë³´ì¡´í•˜ê³ , ë¶ˆí•„ìš”í•œ ì£¼ì„ì´ë‚˜ ì„¤ëª…ì„ ê³¼ë„í•˜ê²Œ ì¶”ê°€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**

#### ì›ì¹™
1. **ì›ë³¸ ì½”ë“œ ë³´ì¡´ ìš°ì„ **
   - ê¸°ì¡´ ì½”ë“œì˜ êµ¬ì¡°ì™€ ìŠ¤íƒ€ì¼ì„ ìµœëŒ€í•œ ìœ ì§€
   - ê¸°ëŠ¥ ìˆ˜ì •/ì¶”ê°€ ì‹œì—ë„ ì›ë³¸ ì½”ë“œì˜ í˜•íƒœë¥¼ ìµœëŒ€í•œ ë³´ì¡´
   - ë¶ˆí•„ìš”í•œ ë¦¬íŒ©í† ë§ì´ë‚˜ ìŠ¤íƒ€ì¼ ë³€ê²½ ê¸ˆì§€

2. **ì£¼ì„ ì¶”ê°€ ì œí•œ**
   - ê¸°ì¡´ ì½”ë“œì— ì£¼ì„ì´ ì—†ëŠ” ê²½ìš°, ìƒˆë¡œ ì¶”ê°€í•˜ì§€ ì•ŠìŒ
   - ê¸°ì¡´ ì£¼ì„ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ ìœ ì§€í•˜ê±°ë‚˜ ìµœì†Œí•œìœ¼ë¡œ ìˆ˜ì •
   - ì½”ë“œ ìì²´ë¡œ ì´í•´ ê°€ëŠ¥í•œ ê²½ìš° ì£¼ì„ ì¶”ê°€ ê¸ˆì§€
   - ë³µì¡í•œ ë¡œì§ì´ë‚˜ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ ìµœì†Œí•œì˜ ì£¼ì„ í—ˆìš©

3. **ì½”ë“œ ë³€ê²½ ê°€ì´ë“œë¼ì¸**
   ```python
   # âŒ ë‚˜ìœ ì˜ˆ: ê³¼ë„í•œ ì£¼ì„ ì¶”ê°€ë¡œ ì›ë³¸ ì½”ë“œ ë³€ê²½
   def process_message(self, message: str) -> str:
       """
       ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
       ì´ í•¨ìˆ˜ëŠ” ì‚¬ìš©ìë¡œë¶€í„° ë°›ì€ ë©”ì‹œì§€ë¥¼ ë¶„ì„í•˜ê³ 
       ì ì ˆí•œ ì‘ë‹µì„ ìƒì„±í•˜ì—¬ ë°˜í™˜í•©ë‹ˆë‹¤.
       
       Args:
           message (str): ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë©”ì‹œì§€
       
       Returns:
           str: ì²˜ë¦¬ëœ ì‘ë‹µ ë©”ì‹œì§€
       """
       # ë©”ì‹œì§€ ì „ì²˜ë¦¬
       processed = message.strip()
       # ì‘ë‹µ ìƒì„±
       response = self._generate_response(processed)
       # ê²°ê³¼ ë°˜í™˜
       return response
   
   # âœ… ì¢‹ì€ ì˜ˆ: ì›ë³¸ ì½”ë“œ ìµœëŒ€í•œ ë³´ì¡´
   def process_message(self, message: str) -> str:
       processed = message.strip()
       response = self._generate_response(processed)
       return response
   ```

4. **ì£¼ì„ ì¶”ê°€ í—ˆìš© ì¡°ê±´**
   - ë³µì¡í•œ ì•Œê³ ë¦¬ì¦˜ì´ë‚˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ ê²½ìš°
   - ì™¸ë¶€ APIë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ íŠ¹ì´í•œ ë™ì‘ì„ ì„¤ëª…í•˜ëŠ” ê²½ìš°
   - ë²„ê·¸ ìˆ˜ì •ì´ë‚˜ ì„ì‹œ í•´ê²°ì±…ì„ í‘œì‹œí•˜ëŠ” ê²½ìš° (TODO, FIXME, HACK ë“±)
   - ê¸°ì¡´ ì£¼ì„ì´ ì˜ëª»ëœ ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆì–´ ìˆ˜ì •ì´ í•„ìš”í•œ ê²½ìš°

5. **ê¸ˆì§€ ì‚¬í•­**
   - ëª…í™•í•œ ì½”ë“œì— ì„¤ëª… ì£¼ì„ ì¶”ê°€
   - ë³€ìˆ˜ëª…ì´ë‚˜ í•¨ìˆ˜ëª…ìœ¼ë¡œ ì¶©ë¶„íˆ ì„¤ëª…ë˜ëŠ” ê²½ìš° ì£¼ì„ ì¶”ê°€
   - ê¸°ì¡´ ì½”ë“œ ìŠ¤íƒ€ì¼ê³¼ ë‹¤ë¥¸ ì£¼ì„ ìŠ¤íƒ€ì¼ ê°•ì œ ì ìš©
   - ë¬¸ì„œí™” ë¬¸ìì—´(docstring)ì„ ëª¨ë“  í•¨ìˆ˜ì— ê°•ì œë¡œ ì¶”ê°€

6. **ì˜ˆì™¸ ì‚¬í•­**
   - ê³µê°œ APIë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•¨ìˆ˜ëŠ” docstring í•„ìš”
   - ë³µì¡í•œ ìˆ˜í•™ì  ì•Œê³ ë¦¬ì¦˜ì´ë‚˜ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì€ ì£¼ì„ í—ˆìš©
   - íŒ€ ë‚´ë¶€ ê·œì¹™ìœ¼ë¡œ ë¬¸ì„œí™”ê°€ í•„ìš”í•œ ê²½ìš°

### 1. íŒŒì¼ ëª…ëª… ê·œì¹™
- **Python íŒŒì¼**: snake_case (ì˜ˆ: `chat_service.py`)
- **í´ë˜ìŠ¤**: PascalCase (ì˜ˆ: `ChatService`)
- **í•¨ìˆ˜/ë³€ìˆ˜**: snake_case (ì˜ˆ: `process_message`)
- **ìƒìˆ˜**: UPPER_SNAKE_CASE (ì˜ˆ: `MAX_RETRY_COUNT`)

### 2. Import ê·œì¹™
```python
# í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬
import os
import sys
from typing import List, Dict, Optional

# ì„œë“œíŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬
import torch
import numpy as np
import pandas as pd
from fastapi import FastAPI
from transformers import AutoTokenizer

# ë¡œì»¬ ëª¨ë“ˆ
from source.models.kobart_model import KoBARTModel
from source.services.chat_service import ChatService
from source.utils.config import Config
```

### 3. í´ë˜ìŠ¤ êµ¬ì¡° ê·œì¹™
```python
class ServiceName:
    """ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ì— ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ëª…"""
    
    def __init__(self, config: Config):
        """ì´ˆê¸°í™” ë©”ì„œë“œ"""
        self.config = config
        self._initialize_components()
    
    def _initialize_components(self):
        """ë‚´ë¶€ ì»´í¬ë„ŒíŠ¸ ì´ˆê¸°í™” (private ë©”ì„œë“œ)"""
        pass
    
    def public_method(self, param: str) -> str:
        """ê³µê°œ ë©”ì„œë“œì— ëŒ€í•œ ì„¤ëª…"""
        pass
```

### 4. ì—ëŸ¬ ì²˜ë¦¬ ê·œì¹™
```python
import logging
from typing import Optional

logger = logging.getLogger(__name__)

def safe_operation(self, data: str) -> Optional[str]:
    """ì•ˆì „í•œ ì—°ì‚° ìˆ˜í–‰"""
    try:
        result = self._process_data(data)
        return result
    except ValueError as e:
        logger.error(f"Value error in safe_operation: {e}")
        return None
    except Exception as e:
        logger.error(f"Unexpected error in safe_operation: {e}")
        raise
```

### 5. Linter ì˜¤ë¥˜ ë°©ì§€ ê·œì¹™ (CRITICAL)

**íŒŒì´ì¬ ê°œë°œ ì‹œ linter ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.**

#### ì›ì¹™
1. **Linter ì˜¤ë¥˜ ì œë¡œ ëª©í‘œ**
   - ì½”ë“œ ì‘ì„± ì‹œ linter ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ì£¼ì˜
   - ì½”ë“œ ìˆ˜ì • í›„ linter ê²€ì‚¬ë¥¼ ì‹¤í–‰í•˜ì—¬ ì˜¤ë¥˜ í™•ì¸
   - ëª¨ë“  linter ì˜¤ë¥˜ëŠ” ë°˜ë“œì‹œ ìˆ˜ì •í•´ì•¼ í•¨

2. **ì£¼ìš” Linter ì˜¤ë¥˜ ìœ í˜• ë° í•´ê²° ë°©ë²•**

   **a. ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ë³€ìˆ˜ (Unused Variable)**
   ```python
   # âŒ ë‚˜ìœ ì˜ˆ: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ë³€ìˆ˜
   result = asyncio.run(run_query_test(query))
   return 0  # result ë³€ìˆ˜ê°€ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ
   
   # âœ… ì¢‹ì€ ì˜ˆ 1: ë³€ìˆ˜ ì œê±°
   asyncio.run(run_query_test(query))
   return 0
   
   # âœ… ì¢‹ì€ ì˜ˆ 2: ë³€ìˆ˜ ì‚¬ìš©
   result = asyncio.run(run_query_test(query))
   if result:
       logger.info(f"Test completed with result: {result}")
   return 0
   
   # âœ… ì¢‹ì€ ì˜ˆ 3: ì˜ë„ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš° ì–¸ë”ìŠ¤ì½”ì–´ ì‚¬ìš©
   _result = asyncio.run(run_query_test(query))  # linter ê²½ê³  ë¬´ì‹œ
   return 0
   ```

   **b. í”Œë ˆì´ìŠ¤í™€ë”ê°€ ì—†ëŠ” f-string**
   ```python
   # âŒ ë‚˜ìœ ì˜ˆ: í”Œë ˆì´ìŠ¤í™€ë”ê°€ ì—†ëŠ” f-string
   logger.warning(f"\nâš ï¸  related_questionsê°€ ì—†ìŠµë‹ˆë‹¤!")
   logger.info(f"   ì „ì²´ êµ¬ì¡°:")
   
   # âœ… ì¢‹ì€ ì˜ˆ: ì¼ë°˜ ë¬¸ìì—´ ì‚¬ìš©
   logger.warning("\nâš ï¸  related_questionsê°€ ì—†ìŠµë‹ˆë‹¤!")
   logger.info("   ì „ì²´ êµ¬ì¡°:")
   
   # âœ… ì¢‹ì€ ì˜ˆ: í”Œë ˆì´ìŠ¤í™€ë”ê°€ ìˆëŠ” ê²½ìš°ë§Œ f-string ì‚¬ìš©
   logger.warning(f"\nâš ï¸  related_questionsê°€ ì—†ìŠµë‹ˆë‹¤! (count: {len(questions)})")
   logger.info(f"   ì „ì²´ êµ¬ì¡°: {structure}")
   ```

   **c. ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” import**
   ```python
   # âŒ ë‚˜ìœ ì˜ˆ: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” import
   import os
   import sys
   from typing import List, Dict, Optional
   
   def process_data(data: str) -> str:
       return data.upper()  # os, sys, List, Dict, Optional ë¯¸ì‚¬ìš©
   
   # âœ… ì¢‹ì€ ì˜ˆ: ì‚¬ìš©í•˜ëŠ” ê²ƒë§Œ import
   def process_data(data: str) -> str:
       return data.upper()
   ```

   **d. íƒ€ì… íŒíŠ¸ ëˆ„ë½**
   ```python
   # âŒ ë‚˜ìœ ì˜ˆ: íƒ€ì… íŒíŠ¸ ëˆ„ë½
   def process_data(data):
       return data.upper()
   
   # âœ… ì¢‹ì€ ì˜ˆ: íƒ€ì… íŒíŠ¸ í¬í•¨
   def process_data(data: str) -> str:
       return data.upper()
   ```

   **e. ë„ˆë¬´ ê¸´ ì¤„ (Line too long)**
   ```python
   # âŒ ë‚˜ìœ ì˜ˆ: 100ì ì´ìƒì˜ ê¸´ ì¤„
   result = some_very_long_function_name(param1, param2, param3, param4, param5, param6, param7, param8)
   
   # âœ… ì¢‹ì€ ì˜ˆ: ì—¬ëŸ¬ ì¤„ë¡œ ë¶„ë¦¬
   result = some_very_long_function_name(
       param1, param2, param3, param4,
       param5, param6, param7, param8
   )
   ```

   **f. ë¹ˆ except ì ˆ**
   ```python
   # âŒ ë‚˜ìœ ì˜ˆ: ë¹ˆ except ì ˆ
   try:
       process_data()
   except:
       pass
   
   # âœ… ì¢‹ì€ ì˜ˆ: êµ¬ì²´ì ì¸ ì˜ˆì™¸ ì²˜ë¦¬
   try:
       process_data()
   except ValueError as e:
       logger.error(f"Value error: {e}")
   except Exception as e:
       logger.error(f"Unexpected error: {e}")
   ```

3. **Linter ê²€ì‚¬ ì‹¤í–‰ ë°©ë²•**
   ```bash
   # flake8 ê²€ì‚¬
   flake8 source/ --max-line-length=100 --extend-ignore=E203,W503
   
   # pylint ê²€ì‚¬
   pylint source/
   
   # ruff ê²€ì‚¬ (ê¶Œì¥: ë¹ ë¥´ê³  í˜„ëŒ€ì )
   ruff check source/
   ruff check source/ --fix  # ìë™ ìˆ˜ì •
   
   # mypy íƒ€ì… ì²´í¬
   mypy source/
   ```

4. **ì½”ë“œ ì‘ì„± ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸**
   - [ ] ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë³€ìˆ˜ë‚˜ importê°€ ì—†ëŠ”ê°€?
   - [ ] í”Œë ˆì´ìŠ¤í™€ë”ê°€ ì—†ëŠ” f-stringì„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ëŠ”ê°€?
   - [ ] ëª¨ë“  í•¨ìˆ˜ì— íƒ€ì… íŒíŠ¸ê°€ ìˆëŠ”ê°€?
   - [ ] í•œ ì¤„ì´ 100ìë¥¼ ì´ˆê³¼í•˜ì§€ ì•ŠëŠ”ê°€?
   - [ ] ë¹ˆ except ì ˆì„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ëŠ”ê°€?
   - [ ] ì½”ë“œ ìˆ˜ì • í›„ linter ê²€ì‚¬ë¥¼ ì‹¤í–‰í–ˆëŠ”ê°€?

5. **ìë™ ìˆ˜ì • ë„êµ¬ í™œìš©**
   ```bash
   # ruffë¡œ ìë™ ìˆ˜ì • ê°€ëŠ¥í•œ ì˜¤ë¥˜ ìˆ˜ì •
   ruff check source/ --fix
   
   # blackìœ¼ë¡œ ì½”ë“œ í¬ë§·íŒ…
   black source/
   
   # isortë¡œ import ì •ë ¬
   isort source/
   ```

6. **ì˜ˆì™¸ ì²˜ë¦¬ (Linter ì˜¤ë¥˜ ë¬´ì‹œ)**
   ```python
   # í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‚¬ìš© (ìµœì†Œí™”)
   
   # íŠ¹ì • ì¤„ì˜ íŠ¹ì • ì˜¤ë¥˜ ë¬´ì‹œ
   result = asyncio.run(run_query_test(query))  # noqa: F841
   
   # íŠ¹ì • ë¸”ë¡ì˜ íŠ¹ì • ì˜¤ë¥˜ ë¬´ì‹œ
   # pylint: disable=unused-variable
   result = asyncio.run(run_query_test(query))
   # pylint: enable=unused-variable
   
   # íŒŒì¼ ì „ì²´ì˜ íŠ¹ì • ì˜¤ë¥˜ ë¬´ì‹œ (ë¹„ê¶Œì¥)
   # flake8: noqa
   ```

7. **ê¸ˆì§€ ì‚¬í•­**
   - Linter ì˜¤ë¥˜ë¥¼ ë¬´ì‹œí•˜ê³  ì½”ë“œë¥¼ ì»¤ë°‹í•˜ëŠ” ê²ƒ ê¸ˆì§€
   - `# noqa` ì£¼ì„ì„ ë‚¨ìš©í•˜ëŠ” ê²ƒ ê¸ˆì§€ (ì •ë§ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‚¬ìš©)
   - Linter ê²€ì‚¬ë¥¼ ê±´ë„ˆë›°ëŠ” ê²ƒ ê¸ˆì§€
   - ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì½”ë“œë¥¼ ë‚¨ê²¨ë‘ëŠ” ê²ƒ ê¸ˆì§€

8. **ê¶Œì¥ Linter ì„¤ì •**
   - **ruff**: ë¹ ë¥´ê³  í˜„ëŒ€ì ì¸ linter (ê¶Œì¥)
   - **flake8**: ì „í†µì ì¸ linter
   - **pylint**: ìƒì„¸í•œ ì½”ë“œ ë¶„ì„
   - **mypy**: ì •ì  íƒ€ì… ì²´í¬
   - **black**: ì½”ë“œ í¬ë§·í„°
   - **isort**: import ì •ë ¬ ë„êµ¬

## ê¸°ìˆ  ìŠ¤íƒë³„ ê·œì¹™

### 1. Pydantic V2 ê·œì¹™ (CRITICAL)

**ëª¨ë“  Pydantic ëª¨ë¸ì€ ë°˜ë“œì‹œ Pydantic V2 ìŠ¤íƒ€ì¼ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.**

#### ì›ì¹™
1. **Validator ì‚¬ìš©**
   - `@validator` (V1) ì‚¬ìš© ê¸ˆì§€
   - `@field_validator` (V2) ì‚¬ìš© í•„ìˆ˜
   - ëª¨ë“  validatorëŠ” `@classmethod` ë°ì½”ë ˆì´í„°ì™€ í•¨ê»˜ ì‚¬ìš©

2. **Import ê·œì¹™**
   ```python
   # âŒ ë‚˜ìœ ì˜ˆ: Pydantic V1 ìŠ¤íƒ€ì¼
   from pydantic import BaseModel, Field, validator
   
   # âœ… ì¢‹ì€ ì˜ˆ: Pydantic V2 ìŠ¤íƒ€ì¼
   from pydantic import BaseModel, Field, field_validator
   ```

3. **Validator ì‘ì„± ê·œì¹™**
   ```python
   from pydantic import BaseModel, Field, field_validator
   from typing import Optional
   import re
   
   class ExampleModel(BaseModel):
       """ì˜ˆì œ ëª¨ë¸"""
       session_id: Optional[str] = Field(None, description="ì„¸ì…˜ ID")
       message: str = Field(..., min_length=1, max_length=10000)
       
       # âŒ ë‚˜ìœ ì˜ˆ: Pydantic V1 ìŠ¤íƒ€ì¼
       @validator('session_id')
       def validate_session_id(cls, v):
           if v:
               uuid_pattern = r'^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$'
               if not re.match(uuid_pattern, v, re.IGNORECASE):
                   raise ValueError('ìœ íš¨í•˜ì§€ ì•Šì€ ì„¸ì…˜ ID í˜•ì‹ì…ë‹ˆë‹¤')
           return v
       
       # âœ… ì¢‹ì€ ì˜ˆ: Pydantic V2 ìŠ¤íƒ€ì¼
       @field_validator('session_id')
       @classmethod
       def validate_session_id(cls, v):
           if v:
               uuid_pattern = r'^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$'
               if not re.match(uuid_pattern, v, re.IGNORECASE):
                   raise ValueError('ìœ íš¨í•˜ì§€ ì•Šì€ ì„¸ì…˜ ID í˜•ì‹ì…ë‹ˆë‹¤')
           return v
       
       @field_validator('message')
       @classmethod
       def validate_message(cls, v):
           if not v or not v.strip():
               raise ValueError('ë©”ì‹œì§€ëŠ” ë¹„ì–´ìˆì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤')
           return v.strip()
   ```

4. **Config í´ë˜ìŠ¤ ê·œì¹™**
   ```python
   from pydantic import BaseModel, ConfigDict
   
   class ExampleModel(BaseModel):
       """ì˜ˆì œ ëª¨ë¸"""
       # âŒ ë‚˜ìœ ì˜ˆ: Pydantic V1 ìŠ¤íƒ€ì¼
       class Config:
           from_attributes = True
           extra = "ignore"
       
       # âœ… ì¢‹ì€ ì˜ˆ: Pydantic V2 ìŠ¤íƒ€ì¼
       model_config = ConfigDict(
           from_attributes=True,
           extra="ignore"
       )
   ```

5. **ê¸ˆì§€ ì‚¬í•­**
   - `@validator` ì‚¬ìš© ê¸ˆì§€
   - `from pydantic import validator` ì‚¬ìš© ê¸ˆì§€
   - Pydantic V1 ìŠ¤íƒ€ì¼ì˜ Config í´ë˜ìŠ¤ ì‚¬ìš© ê¸ˆì§€ (ê°€ëŠ¥í•œ ê²½ìš°)

6. **ë§ˆì´ê·¸ë ˆì´ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸**
   - [ ] ëª¨ë“  `@validator`ë¥¼ `@field_validator`ë¡œ ë³€ê²½í–ˆëŠ”ê°€?
   - [ ] ëª¨ë“  validator í•¨ìˆ˜ì— `@classmethod` ë°ì½”ë ˆì´í„°ë¥¼ ì¶”ê°€í–ˆëŠ”ê°€?
   - [ ] import ë¬¸ì—ì„œ `validator`ë¥¼ `field_validator`ë¡œ ë³€ê²½í–ˆëŠ”ê°€?
   - [ ] Config í´ë˜ìŠ¤ë¥¼ `model_config`ë¡œ ë³€ê²½í–ˆëŠ”ê°€? (ê°€ëŠ¥í•œ ê²½ìš°)

### 2. FastAPI ê·œì¹™
```python
# api/main.py
from fastapi import FastAPI, HTTPException, Depends
from pydantic import BaseModel
from typing import List, Optional
import sys
import os

# source ëª¨ë“ˆ ê²½ë¡œ ì¶”ê°€
sys.path.append(os.path.join(os.path.dirname(__file__), '..', 'source'))

from services.chat_service import ChatService

app = FastAPI(title="LawFirmAI API", version="1.0.0")

class ChatRequest(BaseModel):
    message: str
    context: Optional[str] = None

class ChatResponse(BaseModel):
    response: str
    confidence: float
    sources: List[str]

# ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
chat_service = ChatService()

@app.post("/api/chat", response_model=ChatResponse)
async def chat_endpoint(request: ChatRequest):
    """ì±„íŒ… ì—”ë“œí¬ì¸íŠ¸"""
    try:
        # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬
        response = chat_service.process_message(request.message)
        return ChatResponse(
            response=response,
            confidence=0.9,
            sources=[]
        )
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000)
```

### 3. React ê·œì¹™
```typescript
// frontend/src/App.tsx
import React, { useState } from 'react';
import { ChatService } from './services/chatService';

function App() {
  const [message, setMessage] = useState('');
  const [response, setResponse] = useState('');
  const chatService = new ChatService();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    const result = await chatService.processMessage(message);
    setResponse(result);
  };

  return (
    <div className="app">
      <h1>ë²•ë¥  AI ì–´ì‹œìŠ¤í„´íŠ¸</h1>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={message}
          onChange={(e) => setMessage(e.target.value)}
          placeholder="ë²•ë¥  ê´€ë ¨ ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”"
        />
        <button type="submit">ì „ì†¡</button>
      </form>
      {response && <div className="response">{response}</div>}
    </div>
  );
}

export default App;
```

### 4. ë°ì´í„°ë² ì´ìŠ¤ ê·œì¹™

#### 4-1. ì—°ê²° í’€ë§ ì‹œìŠ¤í…œ ì‚¬ìš© ê·œì¹™ (CRITICAL)

**SQLite ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì€ ë°˜ë“œì‹œ ì—°ê²° í’€ë§ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.**

##### ì›ì¹™
1. **ì—°ê²° í’€ë§ í•„ìˆ˜ ì‚¬ìš©**
   - ëª¨ë“  SQLite ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì€ `core.data.connection_pool`ì˜ `ThreadLocalConnectionPool` ì‚¬ìš©
   - ë§¤ë²ˆ `sqlite3.connect()`ë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ëŠ” ë°©ì‹ ê¸ˆì§€
   - Thread-local storageë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤ë ˆë“œ ì•ˆì „ì„± ë³´ì¥

2. **ì—°ê²° í’€ ì´ˆê¸°í™” íŒ¨í„´**
   ```python
   # âœ… ì¢‹ì€ ì˜ˆ: ì—°ê²° í’€ ì‚¬ìš©
   from core.data.connection_pool import get_connection_pool
   
   class DatabaseService:
       def __init__(self, db_path: str):
           self.db_path = db_path
           self._connection_pool = get_connection_pool(self.db_path)
       
       def _get_connection(self):
           """ì—°ê²° í’€ì—ì„œ ì—°ê²° ê°€ì ¸ì˜¤ê¸°"""
           return self._connection_pool.get_connection()
       
       def execute_query(self, query: str, params: tuple = ()):
           conn = self._get_connection()
           cursor = conn.cursor()
           cursor.execute(query, params)
           return cursor.fetchall()
   ```

3. **ê¸°ì¡´ ì½”ë“œ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒ¨í„´**
   ```python
   # âŒ ë‚˜ìœ ì˜ˆ: ë§¤ë²ˆ ìƒˆ ì—°ê²° ìƒì„±
   def get_data(self):
       conn = sqlite3.connect(self.db_path)
       cursor = conn.cursor()
       cursor.execute("SELECT * FROM table")
       result = cursor.fetchall()
       conn.close()
       return result
   
   # âœ… ì¢‹ì€ ì˜ˆ: ì—°ê²° í’€ ì‚¬ìš©
   def __init__(self, db_path: str):
       self.db_path = db_path
       try:
           from core.data.connection_pool import get_connection_pool
           self._connection_pool = get_connection_pool(self.db_path)
       except ImportError:
           try:
               from lawfirm_langgraph.core.data.connection_pool import get_connection_pool
               self._connection_pool = get_connection_pool(self.db_path)
           except ImportError:
               self._connection_pool = None
   
   def get_data(self):
       if self._connection_pool:
           conn = self._connection_pool.get_connection()
       else:
           conn = sqlite3.connect(self.db_path)
       cursor = conn.cursor()
       cursor.execute("SELECT * FROM table")
       result = cursor.fetchall()
       if not self._connection_pool:
           conn.close()
       return result
   ```

4. **ì—°ê²° ë‹«ê¸° ì²˜ë¦¬**
   ```python
   # âœ… ì¢‹ì€ ì˜ˆ: ì—°ê²° í’€ ì‚¬ìš© ì‹œ close() í˜¸ì¶œ ìƒëµ ê°€ëŠ¥
   def process_data(self):
       conn = self._connection_pool.get_connection()
       cursor = conn.cursor()
       cursor.execute("SELECT ...")
       result = cursor.fetchall()
       # ì—°ê²° í’€ ì‚¬ìš© ì‹œ conn.close() í˜¸ì¶œ ë¶ˆí•„ìš” (ìë™ ì¬ì‚¬ìš©)
       return result
   
   # âœ… ì¢‹ì€ ì˜ˆ: í´ë°± ì§€ì› (ì—°ê²° í’€ ì—†ì„ ë•Œ)
   def process_data(self):
       if self._connection_pool:
           conn = self._connection_pool.get_connection()
       else:
           conn = sqlite3.connect(self.db_path)
       
       try:
           cursor = conn.cursor()
           cursor.execute("SELECT ...")
           return cursor.fetchall()
       finally:
           if not self._connection_pool:
               conn.close()
   ```

5. **ê¸ˆì§€ ì‚¬í•­**
   - `sqlite3.connect()` ì§ì ‘ í˜¸ì¶œ ê¸ˆì§€ (ì—°ê²° í’€ ì‚¬ìš© í•„ìˆ˜)
   - ì—°ê²° í’€ ì—†ì´ ë§¤ë²ˆ ìƒˆ ì—°ê²° ìƒì„±í•˜ëŠ” ë°©ì‹ ê¸ˆì§€
   - ìŠ¤ë ˆë“œ ê°„ ì—°ê²° ê³µìœ  ê¸ˆì§€ (Thread-local storage ì‚¬ìš© í•„ìˆ˜)

6. **ì ìš© ëŒ€ìƒ**
   - `LegalDataConnectorV2`: `_get_connection()` ë©”ì„œë“œ
   - `SemanticSearchEngineV2`: `_get_connection()` ë©”ì„œë“œ
   - `PerformanceCache`: ëª¨ë“  ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ ë©”ì„œë“œ
   - ê¸°íƒ€ SQLite ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  í´ë˜ìŠ¤

7. **ì„±ëŠ¥ ì´ì **
   - ì—°ê²° ìƒì„± ì˜¤ë²„í—¤ë“œ ê°ì†Œ (20-30% ì„±ëŠ¥ í–¥ìƒ)
   - ìŠ¤ë ˆë“œ ì•ˆì „ì„± ë³´ì¥
   - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”

#### 4-2. ê¸°ë³¸ ë°ì´í„°ë² ì´ìŠ¤ ê·œì¹™
```python
import sqlite3
from contextlib import contextmanager
from typing import List, Dict, Any

class DatabaseManager:
    """ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬ í´ë˜ìŠ¤"""
    
    def __init__(self, db_path: str):
        self.db_path = db_path
        # ì—°ê²° í’€ ì´ˆê¸°í™”
        try:
            from core.data.connection_pool import get_connection_pool
            self._connection_pool = get_connection_pool(self.db_path)
        except ImportError:
            self._connection_pool = None
        self._create_tables()
    
    def _get_connection(self):
        """ì—°ê²° í’€ì—ì„œ ì—°ê²° ê°€ì ¸ì˜¤ê¸°"""
        if self._connection_pool:
            return self._connection_pool.get_connection()
        else:
            conn = sqlite3.connect(self.db_path)
            conn.row_factory = sqlite3.Row
            return conn
    
    @contextmanager
    def get_connection(self):
        """ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì»¨í…ìŠ¤íŠ¸ ë§¤ë‹ˆì €"""
        conn = self._get_connection()
        try:
            yield conn
        finally:
            if not self._connection_pool:
                conn.close()
    
    def execute_query(self, query: str, params: tuple = ()) -> List[Dict[str, Any]]:
        """ì¿¼ë¦¬ ì‹¤í–‰"""
        conn = self._get_connection()
        conn.row_factory = sqlite3.Row
        cursor = conn.cursor()
        cursor.execute(query, params)
        result = [dict(row) for row in cursor.fetchall()]
        if not self._connection_pool:
            conn.close()
        return result
```

### 5. AI ëª¨ë¸ ê·œì¹™
```python
import torch
from transformers import AutoTokenizer, AutoModelForCausalLM
from typing import List, Dict, Any

class ModelManager:
    """ëª¨ë¸ ê´€ë¦¬ í´ë˜ìŠ¤"""
    
    def __init__(self, model_name: str, device: str = "cpu"):
        self.model_name = model_name
        self.device = device
        self.model = None
        self.tokenizer = None
        self._load_model()
    
    def _load_model(self):
        """ëª¨ë¸ ë¡œë”©"""
        try:
            self.tokenizer = AutoTokenizer.from_pretrained(self.model_name)
            self.model = AutoModelForCausalLM.from_pretrained(
                self.model_name,
                torch_dtype=torch.float16 if self.device == "cuda" else torch.float32
            )
            self.model.to(self.device)
        except Exception as e:
            raise RuntimeError(f"Failed to load model {self.model_name}: {e}")
    
    def generate_response(self, prompt: str, max_length: int = 512) -> str:
        """ì‘ë‹µ ìƒì„±"""
        inputs = self.tokenizer.encode(prompt, return_tensors="pt").to(self.device)
        
        with torch.no_grad():
            outputs = self.model.generate(
                inputs,
                max_length=max_length,
                num_return_sequences=1,
                temperature=0.7,
                do_sample=True,
                pad_token_id=self.tokenizer.eos_token_id
            )
        
        response = self.tokenizer.decode(outputs[0], skip_special_tokens=True)
        return response
```

### 5-1. í•œêµ­ì–´ ë¶ˆìš©ì–´ ì²˜ë¦¬ ê·œì¹™ (CRITICAL)

**í•œêµ­ì–´ í…ìŠ¤íŠ¸ ì²˜ë¦¬ ì‹œ KoNLPyë¥¼ ìš°ì„ ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬ ë¶ˆìš©ì–´ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.**

#### ì›ì¹™
1. **KoNLPy ìš°ì„  ì‚¬ìš©**
   - ë¶ˆìš©ì–´ ì²˜ë¦¬ëŠ” KoNLPyì˜ í˜•íƒœì†Œ ë¶„ì„ì„ ìš°ì„ ì ìœ¼ë¡œ ì‚¬ìš©
   - KoNLPyê°€ ì‚¬ìš© ë¶ˆê°€ëŠ¥í•œ ê²½ìš°ì—ë§Œ í´ë°±(fallback) ë°©ë²• ì‚¬ìš©
   - í˜•íƒœì†Œ ë¶„ì„ì„ í†µí•´ ì¡°ì‚¬ì™€ ì–´ë¯¸ë¥¼ ìë™ìœ¼ë¡œ ì œê±°

2. **KoNLPy ì´ˆê¸°í™” íŒ¨í„´**
   ```python
   # âœ… ì¢‹ì€ ì˜ˆ: KoNLPy ìš°ì„  ì‚¬ìš© íŒ¨í„´
   class TextProcessor:
       def __init__(self):
           self._okt = None
           try:
               from konlpy.tag import Okt
               self._okt = Okt()
               self.logger.debug("KoNLPy Okt initialized successfully")
           except ImportError:
               self.logger.debug("KoNLPy not available, will use fallback method")
           except Exception as e:
               self.logger.warning(f"Error initializing KoNLPy: {e}, will use fallback method")
   ```

3. **ë¶ˆìš©ì–´ ì²˜ë¦¬ êµ¬í˜„ ê·œì¹™**
   ```python
   from typing import List, Set, Optional
   from konlpy.tag import Okt
   
   class KoreanStopwordProcessor:
       """í•œêµ­ì–´ ë¶ˆìš©ì–´ ì²˜ë¦¬ í´ë˜ìŠ¤"""
       
       # ê¸°ë³¸ ë¶ˆìš©ì–´ ëª©ë¡ (ë²•ë¥  ë„ë©”ì¸ íŠ¹í™”)
       BASIC_STOPWORDS: Set[str] = {
           # ê¸°ë³¸ ì¡°ì‚¬
           'ì—', 'ëŒ€í•´', 'ì„¤ëª…í•´ì£¼ì„¸ìš”', 'ì„¤ëª…', 'ì˜', 'ì„', 'ë¥¼', 'ì´', 'ê°€', 'ëŠ”', 'ì€',
           'ìœ¼ë¡œ', 'ë¡œ', 'ì—ì„œ', 'ì—ê²Œ', 'í•œí…Œ', 'ê»˜', 'ì™€', 'ê³¼', 'í•˜ê³ ', 'ê·¸ë¦¬ê³ ',
           # ì§ˆë¬¸/ìš”ì²­ í‘œí˜„
           'ì–´ë–»ê²Œ', 'ë¬´ì—‡', 'ì–¸ì œ', 'ì–´ë””', 'ì–´ë–¤', 'ë¬´ì—‡ì¸ê°€', 'ìš”ì²­', 'ì§ˆë¬¸',
           # ë²•ë¥  ë„ë©”ì¸ ë¶ˆìš©ì–´
           'ë²•ë¥ ', 'ë²•', 'ì¡°ë¬¸', 'í•­', 'í˜¸', 'ëª©', 'ë‹¨', 'ì ˆ', 'ì¥', 'í¸'
       }
       
       def __init__(self):
           self._okt: Optional[Okt] = None
           try:
               from konlpy.tag import Okt
               self._okt = Okt()
           except (ImportError, Exception):
               self._okt = None
       
       def remove_stopwords(self, text: str) -> List[str]:
           """ë¶ˆìš©ì–´ ì œê±° (KoNLPy ìš°ì„  ì‚¬ìš©)"""
           if self._okt:
               # KoNLPy í˜•íƒœì†Œ ë¶„ì„ ì‚¬ìš©
               morphs = self._okt.morphs(text)
               # ì¡°ì‚¬, ì–´ë¯¸ ì œê±° (ëª…ì‚¬, ë™ì‚¬, í˜•ìš©ì‚¬ë§Œ ì¶”ì¶œ)
               pos_tags = self._okt.pos(text)
               filtered = [
                   word for word, pos in pos_tags
                   if pos in ['Noun', 'Verb', 'Adjective'] 
                   and word not in self.BASIC_STOPWORDS
                   and len(word) >= 2
               ]
               return filtered
           else:
               # í´ë°±: ì •ê·œì‹ ê¸°ë°˜ ì²˜ë¦¬
               import re
               words = re.findall(r'[ê°€-í£]+', text)
               return [
                   w for w in words
                   if w not in self.BASIC_STOPWORDS and len(w) >= 2
               ]
   ```

4. **í˜•íƒœì†Œ ë¶„ì„ ìš°ì„  ì‚¬ìš©**
   ```python
   # âœ… ì¢‹ì€ ì˜ˆ: KoNLPy í˜•íƒœì†Œ ë¶„ì„ ìš°ì„ 
   def extract_keywords(self, query: str) -> List[str]:
       if self._okt:
           # KoNLPy í˜•íƒœì†Œ ë¶„ì„ ì‚¬ìš©
           pos_tags = self._okt.pos(query)
           keywords = [
               word for word, pos in pos_tags
               if pos in ['Noun', 'Verb', 'Adjective']
               and word not in self.BASIC_STOPWORDS
               and len(word) >= 2
           ]
           return keywords
       else:
           # í´ë°±: ì •ê·œì‹ ê¸°ë°˜ ì²˜ë¦¬
           return self._fallback_extraction(query)
   ```

5. **ê¸ˆì§€ ì‚¬í•­**
   - ìˆ˜ë™ ë¶ˆìš©ì–´ ë¦¬ìŠ¤íŠ¸ë§Œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ ê¸ˆì§€ (KoNLPy ì‚¬ìš© ê°€ëŠ¥í•œ ê²½ìš°)
   - KoNLPyë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì •ê·œì‹ë§Œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ ê¸ˆì§€
   - KoNLPy ì´ˆê¸°í™” ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¤ëŠ” ë°©ì‹ ê¸ˆì§€ (í´ë°± í•„ìˆ˜)

6. **ì˜ˆì™¸ ì²˜ë¦¬**
   ```python
   # âœ… ì¢‹ì€ ì˜ˆ: ì•ˆì „í•œ KoNLPy ì‚¬ìš©
   try:
       from konlpy.tag import Okt
       okt = Okt()
       result = okt.pos(text)
   except ImportError:
       # KoNLPy ë¯¸ì„¤ì¹˜ ì‹œ í´ë°±
       result = self._fallback_method(text)
   except Exception as e:
       # ê¸°íƒ€ ì˜¤ë¥˜ ì‹œ í´ë°±
       logger.warning(f"KoNLPy error: {e}, using fallback")
       result = self._fallback_method(text)
   ```

7. **ì˜ì¡´ì„± ê´€ë¦¬**
   - `requirements.txt`ì— `konlpy>=0.6.0` í¬í•¨ ê¶Œì¥
   - KoNLPyëŠ” ì„ íƒì  ì˜ì¡´ì„±ìœ¼ë¡œ ì²˜ë¦¬ (ImportError ì²˜ë¦¬ í•„ìˆ˜)
   - KoNLPy ë¯¸ì„¤ì¹˜ ì‹œì—ë„ ë™ì‘í•˜ë„ë¡ í´ë°± êµ¬í˜„ í•„ìˆ˜

### 6. Batch File (.bat) ê·œì¹™
```batch
@echo off
REM All REM comments in batch files must be written in English only
REM This ensures compatibility across different Windows locales and prevents encoding issues
REM Example of correct usage:
REM Check if virtual environment exists
REM Activate virtual environment
REM Set environment variables

REM Incorrect examples (DO NOT USE):
REM ê°€ìƒ í™˜ê²½ í™•ì¸
REM í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

REM Environment variables (defaults)
if not defined API_HOST set "API_HOST=0.0.0.0"
if not defined API_PORT set "API_PORT=8000"
if not defined LOG_LEVEL set "LOG_LEVEL=info"

REM Start server
echo [INFO] Starting server...
python -m uvicorn api.main:app --host %API_HOST% --port %API_PORT%
```

**Batch File ê·œì¹™ ìš”ì•½:**
- **REM ì£¼ì„**: ë°˜ë“œì‹œ ì˜ì–´ë¡œë§Œ ì‘ì„±
- **ì´ìœ **: ë‹¤ì–‘í•œ Windows ë¡œì¼€ì¼ì—ì„œ í˜¸í™˜ì„± ë³´ì¥ ë° ì¸ì½”ë”© ë¬¸ì œ ë°©ì§€
- **echo ë©”ì‹œì§€**: ì‚¬ìš©ìì—ê²Œ í‘œì‹œë˜ëŠ” ë©”ì‹œì§€ëŠ” í•œê¸€ ì‚¬ìš© ê°€ëŠ¥ (ì¸ì½”ë”© ì„¤ì • í•„ìš” ì‹œ)
- **ë³€ìˆ˜ëª…**: ì˜ì–´ ì‚¬ìš© ê¶Œì¥

## ë¡œê¹… ê·œì¹™ (CRITICAL)

### 1. ë¡œê±° ìƒì„± ë°©ë²•

#### ê¸°ë³¸ íŒ¨í„´ (ê¶Œì¥)
```python
import logging

# ëª¨ë“ˆ ë ˆë²¨ì—ì„œ ë¡œê±° ìƒì„±
logger = logging.getLogger(__name__)
```

#### ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ì‚¬ìš© (ì„ íƒ)
```python
from lawfirm_langgraph.core.utils.logger import get_logger

# í™˜ê²½ ë³€ìˆ˜ LOG_LEVELì„ ì½ì–´ì„œ ìë™ ì„¤ì •
logger = get_logger(__name__)
```

#### í´ë˜ìŠ¤ ë‚´ë¶€ì—ì„œ ë¡œê±° ì‚¬ìš©
```python
class MyService:
    def __init__(self, logger=None):
        # ë¡œê±°ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ê±°ë‚˜ ìƒˆë¡œ ìƒì„±
        self.logger = logger or logging.getLogger(__name__)
    
    def process(self):
        self.logger.info("Processing started")
        try:
            # ì‘ì—… ìˆ˜í–‰
            self.logger.debug("Detailed processing info")
        except Exception as e:
            self.logger.error(f"Error occurred: {e}", exc_info=True)
```

### 2. í™˜ê²½ ë³€ìˆ˜ë¡œ ë¡œê·¸ ë ˆë²¨ ì œì–´

í™˜ê²½ ë³€ìˆ˜ `LOG_LEVEL`ë¡œ ë¡œê·¸ ë ˆë²¨ì„ ì„¤ì •í•©ë‹ˆë‹¤:

```bash
# Windows PowerShell
$env:LOG_LEVEL="DEBUG"

# Linux/Mac
export LOG_LEVEL=DEBUG
```

**ì§€ì› ë ˆë²¨:**
- `CRITICAL` - ê°€ì¥ ì‹¬ê°í•œ ì˜¤ë¥˜ë§Œ
- `ERROR` - ì˜¤ë¥˜ ë©”ì‹œì§€
- `WARNING` - ê²½ê³  ë©”ì‹œì§€
- `INFO` - ì¼ë°˜ ì •ë³´ (ê¸°ë³¸ê°’)
- `DEBUG` - ìƒì„¸ ë””ë²„ê¹… ì •ë³´

**ê¸°ë³¸ê°’**: `INFO`

### 3. ë¡œê·¸ ë ˆë²¨ ì‚¬ìš©ë²•

```python
logger.debug("ìƒì„¸ ë””ë²„ê¹… ì •ë³´")
logger.info("ì¼ë°˜ ì •ë³´ ë©”ì‹œì§€")
logger.warning("ê²½ê³  ë©”ì‹œì§€")
logger.error("ì˜¤ë¥˜ ë©”ì‹œì§€")
logger.critical("ì‹¬ê°í•œ ì˜¤ë¥˜ ë©”ì‹œì§€")
```

### 4. Windows í™˜ê²½ ì£¼ì˜ì‚¬í•­ (CRITICAL)

#### ì´ëª¨ì§€ ì‚¬ìš© ê¸ˆì§€
```python
# âŒ ì˜ëª»ëœ ì˜ˆì‹œ
logger.info("ğŸš€ Starting process...")
logger.info("âœ… Process completed")

# âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ
logger.info("Starting process...")
logger.info("Process completed")
logger.info("[OK] Process completed")
logger.info("[ERROR] Process failed")
```

#### í•œêµ­ì–´ ì¸ì½”ë”© ì²˜ë¦¬ ê·œì¹™

**âš ï¸ ì¤‘ìš”**: Windows í™˜ê²½ì—ì„œ í•œêµ­ì–´ ì½˜ì†” ì¶œë ¥ ë¬¸ì œ í•´ê²°ì„ ìœ„í•œ ê·œì¹™

**í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (í•„ìš” ì‹œ):**
```python
# ëª¨ë“  Python íŒŒì¼ ìƒë‹¨ì— ì¶”ê°€
import os
import sys

# ì¸ì½”ë”© ì„¤ì • (ìµœìš°ì„ )
os.environ['PYTHONIOENCODING'] = 'utf-8'
if sys.platform == 'win32':
    os.environ['PYTHONLEGACYWINDOWSSTDIO'] = 'utf-8'
```

**ì•ˆì „í•œ ì½˜ì†” ì¶œë ¥:**
```python
def safe_print(message: str):
    """ì•ˆì „í•œ ì½˜ì†” ì¶œë ¥ (ì¸ì½”ë”© ì²˜ë¦¬)"""
    try:
        print(message)
    except UnicodeEncodeError:
        print(message.encode('utf-8', errors='replace').decode('utf-8'))

# ì‚¬ìš© ì˜ˆì‹œ
safe_print("ë²•ë¥  ë¬¸ì„œ ë¶„ì„ì„ ì‹œì‘í•©ë‹ˆë‹¤.")
safe_print("ë²¡í„° ì €ì¥ì†Œ ë¡œë”© ì™„ë£Œ")
```

### 5. ì˜ˆì™¸ ë¡œê¹…

```python
try:
    # ì‘ì—… ìˆ˜í–‰
    pass
except Exception as e:
    # ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ í¬í•¨
    logger.error(f"Error occurred: {e}", exc_info=True)
    
    # ë˜ëŠ”
    logger.exception("Error occurred")  # ìë™ìœ¼ë¡œ exc_info=True
```

### 6. ë¡œê·¸ í¬ë§·

**ê¸°ë³¸ í¬ë§·:**
```
%(asctime)s - %(name)s - %(levelname)s - %(message)s
```

**ì˜ˆì‹œ:**
```
2024-01-15 10:30:45 - lawfirm_langgraph.core.workflow - INFO - Workflow initialized
```

### 7. ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ

```python
# lawfirm_langgraph/core/workflow/legal_workflow_enhanced.py
import logging

logger = logging.getLogger(__name__)

class LegalWorkflowEnhanced:
    def __init__(self):
        self.logger = logging.getLogger(__name__)
        self.logger.info("LegalWorkflowEnhanced initialized")
    
    def process(self):
        self.logger.debug("Processing started")
        self.logger.info("Processing completed")
```

### 8. ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œê¹… ì œì–´

í”„ë¡œì íŠ¸ëŠ” ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œê¹…ì„ ìë™ìœ¼ë¡œ ë¹„í™œì„±í™”í•©ë‹ˆë‹¤:
- `faiss`, `sentence_transformers`, `transformers`, `torch`
- `numpy`, `scipy`, `sklearn`
- `requests`, `urllib3`, `httpx`
- ê¸°íƒ€ ML ë¼ì´ë¸ŒëŸ¬ë¦¬

ì´ë“¤ì€ `CRITICAL` ë ˆë²¨ë¡œ ì„¤ì •ë˜ì–´ ì¶œë ¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

### 9. ë¡œê¹… ê·œì¹™ ìš”ì•½

1. **ë¡œê±° ìƒì„±**: `logger = logging.getLogger(__name__)`
2. **ë¡œê·¸ ë ˆë²¨**: í™˜ê²½ ë³€ìˆ˜ `LOG_LEVEL`ë¡œ ì œì–´ (ê¸°ë³¸ê°’: INFO)
3. **Windows**: ì´ëª¨ì§€ ì‚¬ìš© ê¸ˆì§€, ì¸ì½”ë”© ì„¤ì • í•„ìš” ì‹œ ì¶”ê°€
4. **ì˜ˆì™¸ ì²˜ë¦¬**: `logger.error(..., exc_info=True)` ë˜ëŠ” `logger.exception()`
5. **í´ë˜ìŠ¤**: `self.logger = logger or logging.getLogger(__name__)` íŒ¨í„´ ì‚¬ìš©

## ì„±ëŠ¥ ìµœì í™” ê·œì¹™

### 1. ë©”ëª¨ë¦¬ ê´€ë¦¬
- ëª¨ë¸ ë¡œë”© ì‹œ ì§€ì—° ë¡œë”© ì‚¬ìš©
- ë¶ˆí•„ìš”í•œ ë³€ìˆ˜ ì¦‰ì‹œ ì‚­ì œ (`del variable`)
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§

### 2. ìºì‹± ì „ëµ
```python
from functools import lru_cache
from typing import Optional

class CachedService:
    """ìºì‹±ì´ ì ìš©ëœ ì„œë¹„ìŠ¤"""
    
    def __init__(self):
        self._cache = {}
    
    @lru_cache(maxsize=128)
    def cached_operation(self, key: str) -> str:
        """ìºì‹±ëœ ì—°ì‚°"""
        if key in self._cache:
            return self._cache[key]
        
        result = self._expensive_operation(key)
        self._cache[key] = result
        return result
```

### 3. ë¹„ë™ê¸° ì²˜ë¦¬
```python
import asyncio
from typing import List, Dict, Any

class AsyncService:
    """ë¹„ë™ê¸° ì„œë¹„ìŠ¤"""
    
    async def process_batch(self, items: List[str]) -> List[Dict[str, Any]]:
        """ë°°ì¹˜ ì²˜ë¦¬"""
        tasks = [self._process_item(item) for item in items]
        results = await asyncio.gather(*tasks, return_exceptions=True)
        return results
    
    async def _process_item(self, item: str) -> Dict[str, Any]:
        """ê°œë³„ ì•„ì´í…œ ì²˜ë¦¬"""
        # ë¹„ë™ê¸° ì²˜ë¦¬ ë¡œì§
        pass
```

## í…ŒìŠ¤íŠ¸ ê·œì¹™

### 1. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
```python
import pytest
from unittest.mock import Mock, patch
from source.services.chat_service import ChatService

class TestChatService:
    """ChatService í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤"""
    
    def setup_method(self):
        """í…ŒìŠ¤íŠ¸ ì„¤ì •"""
        self.chat_service = ChatService()
    
    def test_process_message_success(self):
        """ë©”ì‹œì§€ ì²˜ë¦¬ ì„±ê³µ í…ŒìŠ¤íŠ¸"""
        message = "ê³„ì•½ì„œ ê²€í†  ìš”ì²­"
        result = self.chat_service.process_message(message)
        assert isinstance(result, str)
        assert len(result) > 0
    
    def test_process_message_empty_input(self):
        """ë¹ˆ ì…ë ¥ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸"""
        with pytest.raises(ValueError):
            self.chat_service.process_message("")
    
    @patch('source.models.kobart_model.KoBARTModel')
    def test_process_message_with_mock(self, mock_model):
        """ëª¨í‚¹ì„ ì‚¬ìš©í•œ í…ŒìŠ¤íŠ¸"""
        mock_model.return_value.generate.return_value = "í…ŒìŠ¤íŠ¸ ì‘ë‹µ"
        result = self.chat_service.process_message("í…ŒìŠ¤íŠ¸")
        assert result == "í…ŒìŠ¤íŠ¸ ì‘ë‹µ"
```

### 2. í†µí•© í…ŒìŠ¤íŠ¸
```python
# tests/integration/test_api.py
import pytest
import sys
import os
from fastapi.testclient import TestClient

# source ëª¨ë“ˆ ê²½ë¡œ ì¶”ê°€
sys.path.append(os.path.join(os.path.dirname(__file__), '..', '..', 'source'))

from api.main import app

client = TestClient(app)

def test_chat_endpoint():
    """ì±„íŒ… ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸"""
    response = client.post(
        "/api/chat",
        json={"message": "ê³„ì•½ì„œ ê²€í†  ìš”ì²­"}
    )
    assert response.status_code == 200
    assert "response" in response.json()

# tests/integration/test_frontend.tsx
import React from 'react';
import { render, screen } from '@testing-library/react';
import App from '../../frontend/src/App';

describe('App Component', () => {
  it('renders the app correctly', () => {
    render(<App />);
    expect(screen.getByText('ë²•ë¥  AI ì–´ì‹œìŠ¤í„´íŠ¸')).toBeInTheDocument();
  });

  it('handles message submission', async () => {
    render(<App />);
    const input = screen.getByPlaceholderText('ë²•ë¥  ê´€ë ¨ ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”');
    const button = screen.getByText('ì „ì†¡');
    
    // í…ŒìŠ¤íŠ¸ ë¡œì§
  });
});
```

## ë¬¸ì„œí™” ê·œì¹™

**ì¤‘ìš”**: ë¬¸ì„œí™” ê·œì¹™ì€ **ìƒˆë¡œìš´ ì½”ë“œ ì‘ì„± ì‹œ**ì—ë§Œ ì ìš©ë©ë‹ˆë‹¤. ê¸°ì¡´ ì½”ë“œì— ë¬¸ì„œí™”ê°€ ì—†ëŠ” ê²½ìš°, ê°•ì œë¡œ ì¶”ê°€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

### 1. í•¨ìˆ˜ ë¬¸ì„œí™”
```python
def process_legal_document(
    document: str,
    document_type: str = "contract",
    analysis_depth: int = 1
) -> Dict[str, Any]:
    """
    ë²•ë¥  ë¬¸ì„œë¥¼ ë¶„ì„í•˜ê³  ì²˜ë¦¬í•©ë‹ˆë‹¤.
    
    Args:
        document (str): ë¶„ì„í•  ë¬¸ì„œ ë‚´ìš©
        document_type (str, optional): ë¬¸ì„œ ìœ í˜•. Defaults to "contract".
        analysis_depth (int, optional): ë¶„ì„ ê¹Šì´ (1-5). Defaults to 1.
    
    Returns:
        Dict[str, Any]: ë¶„ì„ ê²°ê³¼ ë”•ì…”ë„ˆë¦¬
            - summary: ë¬¸ì„œ ìš”ì•½
            - issues: ë°œê²¬ëœ ë¬¸ì œì 
            - recommendations: ê¶Œì¥ì‚¬í•­
            - confidence: ì‹ ë¢°ë„ ì ìˆ˜
    
    Raises:
        ValueError: ë¬¸ì„œê°€ ë¹„ì–´ìˆê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•Šì€ ê²½ìš°
        RuntimeError: ë¶„ì„ ê³¼ì •ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•œ ê²½ìš°
    
    Example:
        >>> result = process_legal_document("ê³„ì•½ì„œ ë‚´ìš©...", "contract", 2)
        >>> print(result["summary"])
    """
    pass
```

### 2. í´ë˜ìŠ¤ ë¬¸ì„œí™”
```python
class LegalDocumentAnalyzer:
    """
    ë²•ë¥  ë¬¸ì„œ ë¶„ì„ì„ ìœ„í•œ í´ë˜ìŠ¤
    
    ì´ í´ë˜ìŠ¤ëŠ” ê³„ì•½ì„œ, íŒë¡€, ë²•ë ¹ ë“±ì˜ ë²•ë¥  ë¬¸ì„œë¥¼ ë¶„ì„í•˜ê³ 
    ì¤‘ìš”í•œ ì •ë³´ë¥¼ ì¶”ì¶œí•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.
    
    Attributes:
        model_manager (ModelManager): AI ëª¨ë¸ ê´€ë¦¬ì
        config (Config): ì„¤ì • ê°ì²´
        cache (Dict): ë¶„ì„ ê²°ê³¼ ìºì‹œ
    
    Example:
        >>> analyzer = LegalDocumentAnalyzer(config)
        >>> result = analyzer.analyze_contract(contract_text)
    """
    pass
```

## ë³´ì•ˆ ê·œì¹™

### 1. ì…ë ¥ ê²€ì¦
```python
from pydantic import BaseModel, field_validator
from typing import Optional

class SecureRequest(BaseModel):
    """ë³´ì•ˆì´ ì ìš©ëœ ìš”ì²­ ëª¨ë¸"""
    message: str
    user_id: Optional[str] = None
    
    @field_validator('message')
    @classmethod
    def validate_message(cls, v):
        if not v or len(v.strip()) == 0:
            raise ValueError('ë©”ì‹œì§€ëŠ” ë¹„ì–´ìˆì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤')
        if len(v) > 10000:
            raise ValueError('ë©”ì‹œì§€ê°€ ë„ˆë¬´ ê¹ë‹ˆë‹¤')
        return v.strip()
    
    @field_validator('user_id')
    @classmethod
    def validate_user_id(cls, v):
        if v and not v.isalnum():
            raise ValueError('ì‚¬ìš©ì IDëŠ” ì˜ìˆ«ìë§Œ í—ˆìš©ë©ë‹ˆë‹¤')
        return v
```

### 2. í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬
```python
import os
from typing import Optional

class Config:
    """ì„¤ì • ê´€ë¦¬ í´ë˜ìŠ¤"""
    
    def __init__(self):
        self.database_url = os.getenv("DATABASE_URL", "sqlite:///./data/lawfirm.db")
        self.model_path = os.getenv("MODEL_PATH", "./models")
        self.api_key = os.getenv("API_KEY")
        
        if not self.api_key:
            raise ValueError("API_KEY í™˜ê²½ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤")
```

## ë°°í¬ ê·œì¹™

### 1. Docker ìµœì í™”

#### React Dockerfile
```dockerfile
# frontend/Dockerfile
# ë©€í‹°ìŠ¤í…Œì´ì§€ ë¹Œë“œ ì‚¬ìš©
FROM node:18-alpine as builder

WORKDIR /app
COPY frontend/package*.json ./
RUN npm ci

COPY frontend/ ./
RUN npm run build

FROM nginx:alpine

# ë¹Œë“œëœ íŒŒì¼ ë³µì‚¬
COPY --from=builder /app/dist /usr/share/nginx/html

# Nginx ì„¤ì •
COPY frontend/nginx.conf /etc/nginx/conf.d/default.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

#### FastAPI Dockerfile
```dockerfile
# api/Dockerfile
# ë©€í‹°ìŠ¤í…Œì´ì§€ ë¹Œë“œ ì‚¬ìš©
FROM python:3.9-slim as builder

WORKDIR /app
COPY api/requirements.txt .
RUN pip install --no-cache-dir --user -r requirements.txt

FROM python:3.9-slim

# ë³´ì•ˆì„ ìœ„í•œ non-root ì‚¬ìš©ì ìƒì„±
RUN useradd --create-home --shell /bin/bash app
USER app

WORKDIR /app

# ë¹Œë“œëœ íŒ¨í‚¤ì§€ ë³µì‚¬
COPY --from=builder /root/.local /home/app/.local

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ë³µì‚¬
COPY --chown=app:app api/ ./api/
COPY --chown=app:app source/ ./source/

# PATH ì„¤ì •
ENV PATH=/home/app/.local/bin:$PATH

EXPOSE 8000

CMD ["python", "api/main.py"]
```

### 2. í™˜ê²½ë³„ ì„¤ì •
```python
# config.py
import os
from enum import Enum

class Environment(Enum):
    DEVELOPMENT = "development"
    STAGING = "staging"
    PRODUCTION = "production"

class Config:
    def __init__(self):
        self.env = Environment(os.getenv("ENVIRONMENT", "development"))
        self.debug = self.env == Environment.DEVELOPMENT
        self.log_level = "DEBUG" if self.debug else "INFO"
```

## Git ê·œì¹™

### 1. ì»¤ë°‹ ë©”ì‹œì§€ ê·œì¹™
```
<type>(<scope>): <subject>

<body>

<footer>
```

**Type**: feat, fix, docs, style, refactor, test, chore
**Scope**: models, services, api, data, utils
**Subject**: 50ì ì´ë‚´, ëª…ë ¹í˜•
**Body**: 72ì ì´ë‚´ë¡œ ì¤„ë°”ê¿ˆ, ë¬´ì—‡ì„ ì™œ ë³€ê²½í–ˆëŠ”ì§€ ì„¤ëª…
**Footer**: Breaking changes, Issues ì°¸ì¡°

**ì˜ˆì‹œ**:
```
feat(chat): add message validation and error handling

- Add input validation for chat messages
- Implement proper error handling for invalid inputs
- Add logging for debugging purposes

Closes #123
```

### 2. ë¸Œëœì¹˜ ê·œì¹™
- `main`: í”„ë¡œë•ì…˜ ë¸Œëœì¹˜
- `develop`: ê°œë°œ ë¸Œëœì¹˜
- `feature/`: ê¸°ëŠ¥ ê°œë°œ ë¸Œëœì¹˜
- `hotfix/`: ê¸´ê¸‰ ìˆ˜ì • ë¸Œëœì¹˜
- `release/`: ë¦´ë¦¬ìŠ¤ ì¤€ë¹„ ë¸Œëœì¹˜

## ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ê·œì¹™

### 1. ë©”íŠ¸ë¦­ ìˆ˜ì§‘
```python
import time
from functools import wraps

def measure_time(func):
    """ì‹¤í–‰ ì‹œê°„ ì¸¡ì • ë°ì½”ë ˆì´í„°"""
    @wraps(func)
    def wrapper(*args, **kwargs):
        start_time = time.time()
        result = func(*args, **kwargs)
        end_time = time.time()
        
        logger.info(f"{func.__name__} executed in {end_time - start_time:.2f} seconds")
        return result
    return wrapper
```

## ì½”ë“œ ë¦¬ë·° ì²´í¬ë¦¬ìŠ¤íŠ¸

### í•„ìˆ˜ ì²´í¬ í•­ëª©
- [ ] **ê¸°ì¡´ íŒŒì¼ ìˆ˜ì •ì„ ìš°ì„ ì ìœ¼ë¡œ ê³ ë ¤í–ˆëŠ”ê°€?** (CRITICAL)
- [ ] **ì‹ ê·œ íŒŒì¼ ìƒì„±ì´ ì •ë§ í•„ìš”í•œê°€?** (ê¸°ì¡´ íŒŒì¼ ìˆ˜ì •ìœ¼ë¡œ ë¶ˆê°€ëŠ¥í•œê°€?)
- [ ] **ì›ë³¸ ì½”ë“œë¥¼ ìµœëŒ€í•œ ë³´ì¡´í–ˆëŠ”ê°€?** (CRITICAL)
- [ ] **ë¶ˆí•„ìš”í•œ ì£¼ì„ì„ ê³¼ë„í•˜ê²Œ ì¶”ê°€í•˜ì§€ ì•Šì•˜ëŠ”ê°€?** (CRITICAL)
- [ ] **Pydantic V2 ìŠ¤íƒ€ì¼ì„ ì‚¬ìš©í–ˆëŠ”ê°€?** (`@field_validator` ì‚¬ìš©, `@validator` ì‚¬ìš© ê¸ˆì§€) (CRITICAL)
- [ ] **í•œêµ­ì–´ ë¶ˆìš©ì–´ ì²˜ë¦¬ ì‹œ KoNLPyë¥¼ ìš°ì„ ì ìœ¼ë¡œ ì‚¬ìš©í–ˆëŠ”ê°€?** (KoNLPy ì‚¬ìš© ê°€ëŠ¥ ì‹œ í˜•íƒœì†Œ ë¶„ì„ ì‚¬ìš©, í´ë°± êµ¬í˜„ í•„ìˆ˜) (CRITICAL)
- [ ] **ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í’€ë§ ì‹œìŠ¤í…œì„ ì‚¬ìš©í–ˆëŠ”ê°€?** (`sqlite3.connect()` ì§ì ‘ í˜¸ì¶œ ê¸ˆì§€, `get_connection_pool()` ì‚¬ìš© í•„ìˆ˜) (CRITICAL)
- [ ] **Linter ì˜¤ë¥˜ê°€ ì—†ëŠ”ê°€?** (ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ë³€ìˆ˜, í”Œë ˆì´ìŠ¤í™€ë” ì—†ëŠ” f-string, ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” import ë“±) (CRITICAL)
- [ ] ì½”ë“œê°€ í”„ë¡œì íŠ¸ êµ¬ì¡° ê·œì¹™ì„ ë”°ë¥´ëŠ”ê°€?
- [ ] í•¨ìˆ˜ì™€ í´ë˜ìŠ¤ì— ì ì ˆí•œ ë¬¸ì„œí™”ê°€ ìˆëŠ”ê°€?
- [ ] ì—ëŸ¬ ì²˜ë¦¬ê°€ ì ì ˆíˆ êµ¬í˜„ë˜ì–´ ìˆëŠ”ê°€?
- [ ] í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ ì‘ì„±ë˜ì–´ ìˆëŠ”ê°€?
- [ ] ì„±ëŠ¥ ìµœì í™”ê°€ ê³ ë ¤ë˜ì—ˆëŠ”ê°€?
- [ ] ë³´ì•ˆ ê²€ì¦ì´ ì ìš©ë˜ì–´ ìˆëŠ”ê°€?
- [ ] ë¡œê¹…ì´ ì ì ˆíˆ êµ¬í˜„ë˜ì–´ ìˆëŠ”ê°€?

### ê¶Œì¥ ì²´í¬ í•­ëª©
- [ ] ì½”ë“œê°€ ì¬ì‚¬ìš© ê°€ëŠ¥í•œê°€?
- [ ] ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ìµœì í™”ë˜ì–´ ìˆëŠ”ê°€?
- [ ] ë¹„ë™ê¸° ì²˜ë¦¬ê°€ í•„ìš”í•œ ë¶€ë¶„ì— ì ìš©ë˜ì—ˆëŠ”ê°€?
- [ ] ìºì‹± ì „ëµì´ ì ì ˆí•œê°€?
- [ ] ëª¨ë‹ˆí„°ë§ì´ ê°€ëŠ¥í•œê°€?

## í…ŒìŠ¤íŠ¸ ë¡œê·¸ íŒŒì¼ ì €ì¥ ê·œì¹™

### run_query_test.py ë¡œê·¸ íŒŒì¼ ì €ì¥

**run_query_test.py** ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•  ë•Œ ë¡œê·¸ë¥¼ íŒŒì¼ë¡œ ì €ì¥í•˜ì—¬ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ìë™ ë¡œê·¸ íŒŒì¼ ìƒì„± (ê¸°ë³¸)

ê¸°ë³¸ì ìœ¼ë¡œ ë¡œê·¸ íŒŒì¼ì€ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤:

```bash
python lawfirm_langgraph/tests/scripts/run_query_test.py "ê³„ì•½ í•´ì§€ ì‚¬ìœ ì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”"
```

**ë¡œê·¸ íŒŒì¼ ìœ„ì¹˜**: `logs/test/run_query_test_YYYYMMDD_HHMMSS.log`

#### í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

**ë¡œê·¸ íŒŒì¼ ê²½ë¡œ ì§€ì •**:
```powershell
$env:TEST_LOG_FILE="logs/test/my_test.log"
python lawfirm_langgraph/tests/scripts/run_query_test.py "ì§ˆì˜ ë‚´ìš©"
```

**ë¡œê·¸ ë””ë ‰í† ë¦¬ ë³€ê²½**:
```powershell
$env:TEST_LOG_DIR="logs/custom_test"
python lawfirm_langgraph/tests/scripts/run_query_test.py "ì§ˆì˜ ë‚´ìš©"
```

**ë¡œê·¸ ë ˆë²¨ ì„¤ì •**:
```powershell
$env:TEST_LOG_LEVEL="DEBUG"  # DEBUG, INFO, WARNING, ERROR
python lawfirm_langgraph/tests/scripts/run_query_test.py "ì§ˆì˜ ë‚´ìš©"
```

#### ë¡œê·¸ ë¶„ì„ ì˜ˆì‹œ

**ì„±ëŠ¥ ë©”íŠ¸ë¦­ ì¶”ì¶œ**:
```powershell
Select-String -Pattern "PERFORMANCE|process_search_results_combined|expand_keywords" logs/test/run_query_test_*.log
```

**Keyword Coverage ì¶”ì¶œ**:
```powershell
Select-String -Pattern "Keyword Coverage" logs/test/run_query_test_*.log
```

**ì—ëŸ¬ ë¡œê·¸ ì¶”ì¶œ**:
```powershell
Select-String -Pattern "ERROR|âŒ|âš ï¸" logs/test/run_query_test_*.log
```

**ë©”íƒ€ë°ì´í„° ì˜¤íƒ€ í™•ì¸**:
```powershell
Select-String -Pattern "interpretation_id|interpretatiion_id|interpretattion_id|Normalized typo|Fixed typo" logs/test/run_query_test_*.log
```

#### í™˜ê²½ ë³€ìˆ˜ ìš”ì•½

| í™˜ê²½ ë³€ìˆ˜ | ì„¤ëª… | ê¸°ë³¸ê°’ |
|---------|------|--------|
| `TEST_LOG_FILE` | ë¡œê·¸ íŒŒì¼ ê²½ë¡œ (ì „ì²´ ê²½ë¡œ) | ìë™ ìƒì„± |
| `TEST_LOG_DIR` | ë¡œê·¸ ë””ë ‰í† ë¦¬ | `logs/test` |
| `TEST_LOG_LEVEL` | ë¡œê·¸ ë ˆë²¨ | `INFO` |

**ìì„¸í•œ ë‚´ìš©**: `docs/cursor_rules/run_query_test_logging.md` ì°¸ì¡°

---

ì´ ê·œì¹™ë“¤ì€ LawFirmAI í”„ë¡œì íŠ¸ì˜ ì¼ê´€ì„±ê³¼ í’ˆì§ˆì„ ë³´ì¥í•˜ê¸° ìœ„í•´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. 
í”„ë¡œì íŠ¸ ì§„í–‰ì— ë”°ë¼ í•„ìš”ì— ë”°ë¼ ìˆ˜ì • ë° ë³´ì™„í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
