# LawFirmAI 사용자 가이드

## 🎯 개요

LawFirmAI는 LangGraph 기반 지능형 법률 AI 어시스턴트로, 질문 유형별 최적화된 답변, 하이브리드 검색, 구조화된 답변, 신뢰도 시스템을 제공합니다.

## 🚀 주요 기능

### 핵심 기능
- **지능형 질문 분류**: LangGraph 워크플로우를 통한 자동 질문 분석 및 최적 답변 전략 선택
- **하이브리드 검색**: 의미적 검색과 정확한 매칭을 통합한 검색 시스템
- **구조화된 답변**: 일관된 형식의 전문적이고 읽기 쉬운 답변 제공
- **신뢰도 표시**: 답변의 신뢰성을 수치화하여 사용자에게 투명성 제공
- **State 최적화**: LangGraph State 그룹을 통한 메모리 효율적 처리
- **멀티턴 대화**: 세션 기반 대화 맥락 유지 및 대명사 해결

## 💬 질문 유형별 사용법

### 1. 판례 검색 질문

**질문 예시:**
- "손해배상 관련 판례를 찾아주세요"
- "계약 해제 사건이 있나요?"
- "유사한 법원 판결을 알려주세요"

**특징:**
- 판례 검색에 최적화된 하이브리드 검색
- 사건명, 사건번호, 법원 정보 제공
- 판시사항, 판결요지 등 상세 정보 포함

**답변 구조:**
```
## 관련 판례 분석

### 🔍 판례 분석
[분석 내용]

### 📋 참고 판례
1. **사건명** (사건번호)
   - 법원: [법원명]
   - 판결일: [판결일]
   - 판결요지: [판결요지]

### ⚖️ 적용 법률
[관련 법률 조문]

### 💡 신뢰도 정보
[신뢰도 점수 및 수준]
```

### 2. 법률 문의 질문

**질문 예시:**
- "민법 제750조의 내용이 무엇인가요?"
- "불법행위의 법적 근거를 알려주세요"
- "계약법 규정을 설명해주세요"

**특징:**
- 법률 조문 해석에 최적화된 검색
- 정확한 법률 조문 인용
- 법률의 목적과 취지 설명

**답변 구조:**
```
## 법률 해설

### 📖 법률 해설
[법률 조문 해석]

### ⚖️ 적용 법률
**민법 제750조**
[조문 내용]

### 💼 적용 예시
[실제 적용 사례]

### 💡 신뢰도 정보
[신뢰도 점수 및 수준]
```

### 3. 법적 조언 질문

**질문 예시:**
- "계약 해제 방법을 조언해주세요"
- "손해배상 청구는 어떻게 해야 하나요?"
- "이혼 절차를 알려주세요"

**특징:**
- 법률과 판례 균형잡힌 하이브리드 검색
- 단계별 해결 방법 제시
- 필요한 증거 자료 명시

**답변 구조:**
```
## 법적 조언

### 🎯 법적 조언
[구체적인 조언 내용]

### ⚖️ 적용 법률
[관련 법률 조문]

### 📋 참고 판례
[관련 판례 사건]

### 📝 단계별 가이드
1. [첫 번째 단계]
2. [두 번째 단계]
3. [세 번째 단계]

### 💡 신뢰도 정보
[신뢰도 점수 및 수준]
```

### 4. 절차 안내 질문

**질문 예시:**
- "이혼 절차는 어떻게 진행하나요?"
- "소송 신청 방법을 알려주세요"
- "허가 신청 절차가 궁금합니다"

**특징:**
- 절차 설명에 최적화된 검색
- 단계별 절차 설명
- 필요한 서류와 비용 정보

**답변 구조:**
```
## 절차 안내

### 📊 절차 개요
[절차 전체 개요]

### 📝 단계별 가이드
1. [첫 번째 단계]
2. [두 번째 단계]
3. [세 번째 단계]

### 📄 필요 서류
- [서류 1]
- [서류 2]
- [서류 3]

### ⏰ 처리 기간
[예상 처리 기간]

### 💡 신뢰도 정보
[신뢰도 점수 및 수준]
```

### 5. 용어 해설 질문

**질문 예시:**
- "불법행위의 정의를 알려주세요"
- "계약 해제의 의미가 무엇인가요?"
- "손해배상 개념을 설명해주세요"

**특징:**
- 용어 해설에 최적화된 검색
- 정확한 법률적 정의 제공
- 관련 법률 조문 인용

**답변 구조:**
```
## 용어 해설

### 📚 용어 정의
[정확한 법률적 정의]

### ⚖️ 관련 법률
[관련 법률 조문]

### 💼 적용 예시
[실제 적용 사례]

### 🔗 관련 용어
[관련된 다른 법률 용어들]

### 💡 신뢰도 정보
[신뢰도 점수 및 수준]
```

### 6. 일반 질문

**질문 예시:**
- "법률에 대해 궁금한 것이 있습니다"
- "도움이 필요합니다"
- "정보를 찾고 있습니다"

**특징:**
- 균형잡힌 하이브리드 검색
- 포괄적인 정보 제공
- 사용자 요구에 맞는 답변

## 📊 신뢰도 시스템 이해

### 신뢰도 수준

| 수준 | 점수 범위 | 설명 | 권장사항 |
|------|----------|------|----------|
| 🟢 **HIGH** | 80% 이상 | 높은 신뢰도 | 전문가 수준 답변, 신뢰 가능 |
| 🟡 **MEDIUM** | 60-80% | 보통 신뢰도 | 참고용 답변, 추가 확인 권장 |
| 🟠 **LOW** | 40-60% | 낮은 신뢰도 | 기본 정보만 제공, 전문가 상담 권장 |
| 🔴 **VERY_LOW** | 40% 미만 | 매우 낮은 신뢰도 | 전문가 상담 필수 |

### 신뢰도 계산 요소

1. **검색 결과 유사도** (40%)
   - FAISS 벡터 검색으로 찾은 문서의 유사도
   - SQLite FTS 정확 매칭으로 찾은 키워드 일치도

2. **법률/판례 매칭 정확도** (30%)
   - LangGraph 워크플로우의 질문 분류 결과와 검색 결과의 일치도
   - 관련성 점수

3. **답변 품질** (30%)
   - LLM 생성 답변의 완성도와 구조화 정도
   - 정보의 포괄성 및 법적 근거 제공 여부

## 💡 효과적인 질문 방법

### 1. 구체적인 질문하기

**❌ 좋지 않은 예시:**
- "법률 도움"
- "문제가 있어요"
- "어떻게 해야 하나요?"

**✅ 좋은 예시:**
- "계약 해제 조건이 무엇인가요?"
- "손해배상 청구 방법을 알려주세요"
- "이혼 절차는 어떻게 진행하나요?"

### 2. 질문 유형에 맞는 키워드 사용

**판례 검색:**
- "판례", "사건", "법원", "판결", "참고"

**법률 문의:**
- "법률", "조문", "규정", "법적 근거"

**법적 조언:**
- "조언", "방법", "어떻게", "해야"

**절차 안내:**
- "절차", "신청", "제출", "서류", "기간"

**용어 해설:**
- "의미", "정의", "뜻", "개념", "설명"

### 3. 배경 정보 제공

**질문 예시:**
- "민사 계약에서 계약 해제 조건이 무엇인가요?"
- "교통사고로 인한 손해배상 청구 방법을 알려주세요"
- "가정법원에서 이혼 절차는 어떻게 진행하나요?"

## 🔧 고급 기능

### 1. 세션 기반 대화

**사용법:**
- 질문 시 `session_id` 제공
- 이전 대화 내용을 참고하여 더 정확한 답변 제공
- 대화 맥락 유지

**예시:**
```
첫 번째 질문: "계약 해제 조건이 무엇인가요?"
두 번째 질문: "그럼 해제 절차는 어떻게 되나요?" (이전 질문 맥락 참고)
```

### 2. LangGraph 워크플로우 최적화

**기능:**
- State 그룹을 통한 메모리 효율적 처리
- 노드별 최소 필요한 데이터만 전달
- 처리 단계 최적화

**효과:**
- 메모리 사용량 90% 이상 감소
- 불필요한 데이터 전송 방지
- 응답 시간 단축

### 3. 하이브리드 검색

**기능:**
- 의미적 검색(FAISS)과 정확한 매칭(SQLite FTS) 통합
- 질문 유형별 동적 가중치 조정
- 검색 결과 재순위화

**예시:**
- 법령명 검색: 정확한 매칭 우선
- 개념 질문: 의미적 검색 우선
- 복합 질문: 두 방법 병렬 실행 후 병합

## ⚠️ 주의사항 및 면책 조항

### 면책 조항
- 본 답변은 일반적인 법률 정보 제공을 목적으로 하며, 개별 사안에 대한 법률 자문이 아닙니다.
- 구체적인 법률 문제는 변호사와 직접 상담하시기 바랍니다.
- 답변의 신뢰도가 낮은 경우 전문가 상담을 권장합니다.

### 사용 권장사항

1. **신뢰도 확인**
   - 답변의 신뢰도 수준을 확인하세요
   - LOW 이하의 경우 전문가 상담을 권장합니다

2. **추가 확인**
   - 중요한 법률 문제는 반드시 변호사와 상담하세요
   - 최신 법률 정보는 공식 채널을 통해 확인하세요

3. **개인정보 보호**
   - 개인정보나 민감한 정보는 질문에 포함하지 마세요
   - 세션 ID는 개인 식별이 가능한 정보로 사용하지 마세요

## 🆘 문제 해결

### 자주 묻는 질문

**Q: 답변이 부정확하거나 관련성이 낮아요.**
A: 질문을 더 구체적으로 작성하거나, 질문 유형에 맞는 키워드를 사용해보세요. 신뢰도가 LOW 이하인 경우 전문가 상담을 권장합니다.

**Q: 원하는 정보를 찾을 수 없어요.**
A: 다른 키워드나 질문 방식으로 시도해보세요. 법률 용어 확장 기능이 자동으로 관련 용어를 포함합니다.

**Q: 응답이 너무 느려요.**
A: LangGraph 워크플로우의 State 최적화가 적용되어 있지만, 복잡한 질문의 경우 여러 노드를 거치므로 시간이 더 걸릴 수 있습니다. 질문을 단순화하거나 단계별로 나누어 질문해보세요.

**Q: 이전 대화 내용이 반영되지 않아요.**
A: Streamlit 앱에서는 자동으로 세션을 관리합니다. 브라우저를 새로고침하지 않으면 대화 맥락이 유지됩니다. API 사용 시 `session_id`를 제공하여 대화 맥락을 유지할 수 있습니다.

### 기술적 문제

**API 오류 발생 시:**
1. 요청 형식을 확인하세요 (`/api/v1/chat` 엔드포인트 문서 참조)
2. 필수 파라미터(`message`, `session_id`)가 누락되지 않았는지 확인하세요
3. 서버 상태를 확인하세요

**성능 문제:**
1. 복잡한 질문은 단계별로 나누어 질문하세요
2. 검색 결과 수는 기본값(최대 10개)으로 최적화되어 있습니다
3. Streamlit 앱에서 대기 시간 동안 처리 상태를 확인할 수 있습니다

## 📱 사용 방법

### Streamlit 웹 인터페이스

**시작 방법:**
```bash
cd streamlit
streamlit run app.py
```

**주요 기능:**
- 질문 입력 및 답변 확인
- 신뢰도 점수 확인
- 법적 근거 및 소스 확인
- 대화 이력 자동 관리

**인터페이스 구성:**
- 사이드바: 시스템 정보 및 설정
- 메인 영역: 채팅 인터페이스
- 답변 영역: 구조화된 답변 및 메타데이터 표시

### API 사용

**기본 사용:**
```python
import requests

response = requests.post(
    "http://localhost:8000/api/v1/chat",
    json={
        "message": "계약 해지 조건은?",
        "session_id": "session_123"
    }
)

result = response.json()
print(result["answer"])
```

**응답 구조:**
```json
{
  "answer": "답변 내용...",
  "confidence": 0.85,
  "sources": ["민법 제543조", "판례 2020다12345"],
  "session_id": "session_123",
  "question_type": "law_inquiry",
  "legal_references": ["민법 제543조"],
  "processing_time": 1.2
}
```

## 📚 추가 리소스

- [API 문서](../08_api_documentation/API_Documentation.md)
- [프로젝트 개요](../01_project_overview/project_overview.md)
- [LangGraph 통합 가이드](../05_rag_system/langgraph_integration_guide.md)
- [RAG 시스템 아키텍처](../05_rag_system/rag_architecture.md)
- [Core Modules 가이드](../10_technical_reference/core_modules_guide.md)
- [데이터베이스 스키마](../10_technical_reference/database_schema.md)
