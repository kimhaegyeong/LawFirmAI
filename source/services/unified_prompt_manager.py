# -*- coding: utf-8 -*-
"""
ÌÜµÌï© ÌîÑÎ°¨ÌîÑÌä∏ Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú
Î≤ïÎ•† ÎèÑÎ©îÏù∏ ÌäπÌôî ÌîÑÎ°¨ÌîÑÌä∏Ïùò ÌÜµÌï© Í¥ÄÎ¶¨ Î∞è ÏµúÏ†ÅÌôî
"""

import os
import json
import logging
from datetime import datetime
from typing import Dict, List, Optional, Any, Union
from pathlib import Path
from enum import Enum

from .question_classifier import QuestionType

logger = logging.getLogger(__name__)


class LegalDomain(Enum):
    """Î≤ïÎ•† ÎèÑÎ©îÏù∏ Î∂ÑÎ•ò"""
    CIVIL_LAW = "ÎØºÏÇ¨Î≤ï"
    CRIMINAL_LAW = "ÌòïÏÇ¨Î≤ï"
    FAMILY_LAW = "Í∞ÄÏ°±Î≤ï"
    COMMERCIAL_LAW = "ÏÉÅÏÇ¨Î≤ï"
    ADMINISTRATIVE_LAW = "ÌñâÏ†ïÎ≤ï"
    LABOR_LAW = "ÎÖ∏ÎèôÎ≤ï"
    PROPERTY_LAW = "Î∂ÄÎèôÏÇ∞Î≤ï"
    INTELLECTUAL_PROPERTY = "ÏßÄÏ†ÅÏû¨ÏÇ∞Í∂åÎ≤ï"
    TAX_LAW = "ÏÑ∏Î≤ï"
    CIVIL_PROCEDURE = "ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï"
    CRIMINAL_PROCEDURE = "ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï"
    GENERAL = "Í∏∞ÌÉÄ/ÏùºÎ∞ò"


class ModelType(Enum):
    """ÏßÄÏõê Î™®Îç∏ ÌÉÄÏûÖ"""
    GEMINI = "gemini"
    OLLAMA = "ollama"
    OPENAI = "openai"


class UnifiedPromptManager:
    """ÌÜµÌï© ÌîÑÎ°¨ÌîÑÌä∏ Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú"""
    
    def __init__(self, prompts_dir: str = "gradio/prompts"):
        """ÌÜµÌï© ÌîÑÎ°¨ÌîÑÌä∏ Îß§ÎãàÏ†Ä Ï¥àÍ∏∞Ìôî"""
        self.prompts_dir = Path(prompts_dir)
        self.prompts_dir.mkdir(parents=True, exist_ok=True)
        
        # Í∏∞Î≥∏ ÌîÑÎ°¨ÌîÑÌä∏ Î°úÎìú
        self.base_prompts = self._load_base_prompts()
        self.domain_templates = self._load_domain_templates()
        self.question_type_templates = self._load_question_type_templates()
        self.model_optimizations = self._load_model_optimizations()
        
        logger.info("UnifiedPromptManager initialized successfully")
    
    def _load_base_prompts(self) -> Dict[str, str]:
        """Í∏∞Î≥∏ ÌîÑÎ°¨ÌîÑÌä∏ Î°úÎìú"""
        return {
            "korean_legal_expert": self._get_korean_legal_expert_prompt(),
            "natural_consultant": self._get_natural_consultant_prompt(),
            "professional_advisor": self._get_professional_advisor_prompt()
        }
    
    def _load_domain_templates(self) -> Dict[LegalDomain, Dict[str, Any]]:
        """ÎèÑÎ©îÏù∏Î≥Ñ ÌÖúÌîåÎ¶ø Î°úÎìú"""
        return {
            LegalDomain.CIVIL_LAW: {
                "focus": "Í≥ÑÏïΩ, Î∂àÎ≤ïÌñâÏúÑ, ÏÜåÏú†Í∂å, ÏÉÅÏÜç",
                "key_laws": ["ÎØºÎ≤ï", "ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï", "Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï"],
                "recent_changes": "2024ÎÖÑ ÎØºÎ≤ï Í∞úÏ†ïÏÇ¨Ìï≠ Î∞òÏòÅ",
                "template": self._get_civil_law_template()
            },
            LegalDomain.CRIMINAL_LAW: {
                "focus": "Î≤îÏ£Ñ Íµ¨ÏÑ±ÏöîÍ±¥, ÌòïÎüâ, Ï†àÏ∞®",
                "key_laws": ["ÌòïÎ≤ï", "ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï", "ÌäπÎ≥ÑÎ≤ï"],
                "recent_changes": "ÎîîÏßÄÌÑ∏ ÏÑ±Î≤îÏ£Ñ Ï≤òÎ≤åÎ≤ï Îì± Ïã†ÏÑ§Î≤ï",
                "template": self._get_criminal_law_template()
            },
            LegalDomain.FAMILY_LAW: {
                "focus": "ÌòºÏù∏, Ïù¥Ìòº, ÏπúÏûêÍ¥ÄÍ≥Ñ, ÏÉÅÏÜç",
                "key_laws": ["ÎØºÎ≤ï Í∞ÄÏ°±Ìé∏", "Í∞ÄÏ°±Í¥ÄÍ≥ÑÏùò Îì±Î°ù Îì±Ïóê Í¥ÄÌïú Î≤ïÎ•†"],
                "recent_changes": "2024ÎÖÑ Í∞ÄÏ°±Î≤ï Í∞úÏ†ïÏÇ¨Ìï≠",
                "template": self._get_family_law_template()
            },
            LegalDomain.COMMERCIAL_LAW: {
                "focus": "ÌöåÏÇ¨Î≤ï, ÏÉÅÌñâÏúÑ, Ïñ¥ÏùåÏàòÌëú",
                "key_laws": ["ÏÉÅÎ≤ï", "Ï£ºÏãùÌöåÏÇ¨Î≤ï", "Ïñ¥ÏùåÎ≤ï"],
                "recent_changes": "2024ÎÖÑ ÏÉÅÎ≤ï Í∞úÏ†ïÏÇ¨Ìï≠",
                "template": self._get_commercial_law_template()
            },
            LegalDomain.ADMINISTRATIVE_LAW: {
                "focus": "ÌñâÏ†ïÌñâÏúÑ, ÌñâÏ†ïÏ†àÏ∞®, ÌñâÏ†ïÏÜåÏÜ°",
                "key_laws": ["ÌñâÏ†ïÏ†àÏ∞®Î≤ï", "ÌñâÏ†ïÏÜåÏÜ°Î≤ï", "ÌñâÏ†ïÎ≤ï"],
                "recent_changes": "2024ÎÖÑ ÌñâÏ†ïÎ≤ï Í∞úÏ†ïÏÇ¨Ìï≠",
                "template": self._get_administrative_law_template()
            },
            LegalDomain.LABOR_LAW: {
                "focus": "Í∑ºÎ°úÍ≥ÑÏïΩ, ÏûÑÍ∏à, Í∑ºÎ°úÏãúÍ∞Ñ, Ìú¥Í∞Ä",
                "key_laws": ["Í∑ºÎ°úÍ∏∞Ï§ÄÎ≤ï", "ÎÖ∏ÎèôÏ°∞Ìï©Î≤ï", "Í≥†Ïö©Î≥¥ÌóòÎ≤ï"],
                "recent_changes": "2024ÎÖÑ ÎÖ∏ÎèôÎ≤ï Í∞úÏ†ïÏÇ¨Ìï≠",
                "template": self._get_labor_law_template()
            },
            LegalDomain.PROPERTY_LAW: {
                "focus": "Î∂ÄÎèôÏÇ∞ Í≥ÑÏïΩ, Îì±Í∏∞, Í∂åÎ¶¨Î≥¥Ìò∏",
                "key_laws": ["Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï", "Î∂ÄÎèôÏÇ∞ Ïã§Í∂åÎ¶¨ÏûêÎ™ÖÏùò Îì±Í∏∞Ïóê Í¥ÄÌïú Î≤ïÎ•†"],
                "recent_changes": "2024ÎÖÑ Î∂ÄÎèôÏÇ∞Î≤ï Í∞úÏ†ïÏÇ¨Ìï≠",
                "template": self._get_property_law_template()
            },
            LegalDomain.INTELLECTUAL_PROPERTY: {
                "focus": "ÌäπÌóà, ÏÉÅÌëú, Ï†ÄÏûëÍ∂å, ÎîîÏûêÏù∏",
                "key_laws": ["ÌäπÌóàÎ≤ï", "ÏÉÅÌëúÎ≤ï", "Ï†ÄÏûëÍ∂åÎ≤ï", "ÎîîÏûêÏù∏Î≥¥Ìò∏Î≤ï"],
                "recent_changes": "2024ÎÖÑ ÏßÄÏ†ÅÏû¨ÏÇ∞Í∂åÎ≤ï Í∞úÏ†ïÏÇ¨Ìï≠",
                "template": self._get_intellectual_property_template()
            },
            LegalDomain.TAX_LAW: {
                "focus": "ÏÜåÎìùÏÑ∏, Î≤ïÏù∏ÏÑ∏, Î∂ÄÍ∞ÄÍ∞ÄÏπòÏÑ∏",
                "key_laws": ["ÏÜåÎìùÏÑ∏Î≤ï", "Î≤ïÏù∏ÏÑ∏Î≤ï", "Î∂ÄÍ∞ÄÍ∞ÄÏπòÏÑ∏Î≤ï"],
                "recent_changes": "2024ÎÖÑ ÏÑ∏Î≤ï Í∞úÏ†ïÏÇ¨Ìï≠",
                "template": self._get_tax_law_template()
            },
            LegalDomain.CIVIL_PROCEDURE: {
                "focus": "ÎØºÏÇ¨ÏÜåÏÜ° Ï†àÏ∞®, Ï¶ùÍ±∞, ÏßëÌñâ",
                "key_laws": ["ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï", "ÎØºÏÇ¨ÏßëÌñâÎ≤ï", "Í∞ÄÏÇ¨ÏÜåÏÜ°Î≤ï"],
                "recent_changes": "2024ÎÖÑ ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï Í∞úÏ†ïÏÇ¨Ìï≠",
                "template": self._get_civil_procedure_template()
            },
            LegalDomain.CRIMINAL_PROCEDURE: {
                "focus": "ÌòïÏÇ¨ÏÜåÏÜ° Ï†àÏ∞®, ÏàòÏÇ¨, Ïû¨Ìåê",
                "key_laws": ["ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï", "ÏàòÏÇ¨Ï†àÏ∞®Î≤ï"],
                "recent_changes": "2024ÎÖÑ ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï Í∞úÏ†ïÏÇ¨Ìï≠",
                "template": self._get_criminal_procedure_template()
            }
        }
    
    def _load_question_type_templates(self) -> Dict[QuestionType, Dict[str, Any]]:
        """ÏßàÎ¨∏ Ïú†ÌòïÎ≥Ñ ÌÖúÌîåÎ¶ø Î°úÎìú"""
        return {
            QuestionType.PRECEDENT_SEARCH: {
                "template": self._get_precedent_search_template(),
                "context_keys": ["precedent_list"],
                "max_context_length": 3000,
                "priority": "high"
            },
            QuestionType.LAW_INQUIRY: {
                "template": self._get_law_inquiry_template(),
                "context_keys": ["law_articles"],
                "max_context_length": 2000,
                "priority": "high"
            },
            QuestionType.LEGAL_ADVICE: {
                "template": self._get_legal_advice_template(),
                "context_keys": ["context"],
                "max_context_length": 4000,
                "priority": "high"
            },
            QuestionType.PROCEDURE_GUIDE: {
                "template": self._get_procedure_guide_template(),
                "context_keys": ["procedure_info"],
                "max_context_length": 2500,
                "priority": "medium"
            },
            QuestionType.TERM_EXPLANATION: {
                "template": self._get_term_explanation_template(),
                "context_keys": ["term_info"],
                "max_context_length": 1500,
                "priority": "medium"
            },
            QuestionType.GENERAL_QUESTION: {
                "template": self._get_general_question_template(),
                "context_keys": ["general_context"],
                "max_context_length": 2000,
                "priority": "low"
            }
        }
    
    def _load_model_optimizations(self) -> Dict[ModelType, Dict[str, Any]]:
        """Î™®Îç∏Î≥Ñ ÏµúÏ†ÅÌôî ÏÑ§Ï†ï Î°úÎìú"""
        return {
            ModelType.GEMINI: {
                "max_tokens": 8192,
                "temperature": 0.3,
                "system_prompt_style": "structured",
                "context_window": 0.8
            },
            ModelType.OLLAMA: {
                "max_tokens": 4096,
                "temperature": 0.2,
                "system_prompt_style": "conversational",
                "context_window": 0.7
            },
            ModelType.OPENAI: {
                "max_tokens": 4096,
                "temperature": 0.1,
                "system_prompt_style": "professional",
                "context_window": 0.9
            }
        }
    
    def get_optimized_prompt(self, 
                           query: str,
                           question_type: QuestionType,
                           domain: Optional[LegalDomain] = None,
                           context: Optional[Dict[str, Any]] = None,
                           model_type: ModelType = ModelType.GEMINI,
                           base_prompt_type: str = "korean_legal_expert") -> str:
        """ÏµúÏ†ÅÌôîÎêú ÌîÑÎ°¨ÌîÑÌä∏ ÏÉùÏÑ±"""
        try:
            # 1. Í∏∞Î≥∏ ÌîÑÎ°¨ÌîÑÌä∏ Î°úÎìú
            base_prompt = self.base_prompts.get(base_prompt_type, self.base_prompts["korean_legal_expert"])
            
            # 2. ÎèÑÎ©îÏù∏ ÌäπÌôî Í∞ïÌôî
            if domain and domain in self.domain_templates:
                domain_info = self.domain_templates[domain]
                base_prompt = self._add_domain_specificity(base_prompt, domain_info)
            
            # 3. ÏßàÎ¨∏ Ïú†ÌòïÎ≥Ñ Íµ¨Ï°∞Ìôî
            question_template = self.question_type_templates.get(question_type)
            if question_template:
                base_prompt = self._add_question_structure(base_prompt, question_template)
            
            # 4. Ïª®ÌÖçÏä§Ìä∏ ÏµúÏ†ÅÌôî
            if context:
                base_prompt = self._optimize_context(base_prompt, context, question_template)
            
            # 5. Î™®Îç∏Î≥Ñ ÏµúÏ†ÅÌôî
            model_config = self.model_optimizations.get(model_type)
            if model_config:
                base_prompt = self._model_specific_optimization(base_prompt, model_config)
            
            # 6. ÏµúÏ¢Ö ÌîÑÎ°¨ÌîÑÌä∏ Íµ¨ÏÑ±
            final_prompt = self._build_final_prompt(base_prompt, query, context, question_type)
            
            return final_prompt
            
        except Exception as e:
            logger.error(f"Error generating optimized prompt: {e}")
            return self._get_fallback_prompt(query)
    
    def _add_domain_specificity(self, base_prompt: str, domain_info: Dict[str, Any]) -> str:
        """ÎèÑÎ©îÏù∏ ÌäπÌôî Í∞ïÌôî"""
        domain_specificity = f"""

## ÎèÑÎ©îÏù∏ ÌäπÌôî ÏßÄÏπ®
- **Í¥ÄÎ†® Î∂ÑÏïº**: {domain_info['focus']}
- **Ï£ºÏöî Î≤ïÎ†π**: {', '.join(domain_info['key_laws'])}
- **ÏµúÏã† Í∞úÏ†ïÏÇ¨Ìï≠**: {domain_info['recent_changes']}

{domain_info['template']}
"""
        return base_prompt + domain_specificity
    
    def _add_question_structure(self, base_prompt: str, question_template: Dict[str, Any]) -> str:
        """ÏßàÎ¨∏ Ïú†ÌòïÎ≥Ñ Íµ¨Ï°∞Ìôî"""
        structure_guidance = f"""

## ÎãµÎ≥Ä Íµ¨Ï°∞ Í∞ÄÏù¥Îìú
{question_template['template']}

## Ïª®ÌÖçÏä§Ìä∏ Ï≤òÎ¶¨
- ÏµúÎåÄ Ïª®ÌÖçÏä§Ìä∏ Í∏∏Ïù¥: {question_template['max_context_length']}Ïûê
- Ïö∞ÏÑ†ÏàúÏúÑ: {question_template['priority']}
"""
        return base_prompt + structure_guidance
    
    def _optimize_context(self, base_prompt: str, context: Dict[str, Any], question_template: Dict[str, Any]) -> str:
        """Ïª®ÌÖçÏä§Ìä∏ ÏµúÏ†ÅÌôî"""
        if not context:
            return base_prompt
        
        max_length = question_template.get('max_context_length', 2000)
        context_keys = question_template.get('context_keys', [])
        
        optimized_context = {}
        for key in context_keys:
            if key in context:
                content = context[key]
                if isinstance(content, str) and len(content) > max_length:
                    content = content[:max_length] + "..."
                optimized_context[key] = content
        
        context_guidance = f"""

## Ï†úÍ≥µÎêú Ïª®ÌÖçÏä§Ìä∏
{self._format_context(optimized_context)}
"""
        return base_prompt + context_guidance
    
    def _model_specific_optimization(self, base_prompt: str, model_config: Dict[str, Any]) -> str:
        """Î™®Îç∏Î≥Ñ ÏµúÏ†ÅÌôî"""
        optimization = f"""

## Î™®Îç∏ ÏµúÏ†ÅÌôî ÏÑ§Ï†ï
- ÏµúÎåÄ ÌÜ†ÌÅ∞: {model_config['max_tokens']}
- Ïò®ÎèÑ: {model_config['temperature']}
- Ïä§ÌÉÄÏùº: {model_config['system_prompt_style']}
- Ïª®ÌÖçÏä§Ìä∏ ÏúàÎèÑÏö∞: {model_config['context_window']}
"""
        return base_prompt + optimization
    
    def _build_final_prompt(self, base_prompt: str, query: str, context: Dict[str, Any], question_type: QuestionType) -> str:
        """ÏµúÏ¢Ö ÌîÑÎ°¨ÌîÑÌä∏ Íµ¨ÏÑ±"""
        final_prompt = f"""{base_prompt}

## ÏÇ¨Ïö©Ïûê ÏßàÎ¨∏
{query}

## ÎãµÎ≥Ä ÏöîÍµ¨ÏÇ¨Ìï≠
1. ÏúÑÏùò Î™®Îì† ÏßÄÏπ®ÏùÑ Îî∞Îùº Ï†ïÌôïÌïòÍ≥† Ï†ÑÎ¨∏Ï†ÅÏù∏ ÎãµÎ≥ÄÏùÑ Ï†úÍ≥µÌïòÏÑ∏Ïöî
2. Í¥ÄÎ†® Î≤ïÎ†πÍ≥º ÌåêÎ°ÄÎ•º Ï†ïÌôïÌûà Ïù∏Ïö©ÌïòÏÑ∏Ïöî
3. Ïã§Î¨¥Ï†Å Í¥ÄÏ†êÏóêÏÑú Ïã§Ìñâ Í∞ÄÎä•Ìïú Ï°∞Ïñ∏ÏùÑ Ï†úÍ≥µÌïòÏÑ∏Ïöî
4. Î∂àÌôïÏã§Ìïú Î∂ÄÎ∂ÑÏùÄ Î™ÖÌôïÌûà ÌëúÏãúÌïòÍ≥† Ï†ÑÎ¨∏Í∞Ä ÏÉÅÎã¥ÏùÑ Í∂åÌïòÏÑ∏Ïöî

ÎãµÎ≥ÄÏùÑ ÏãúÏûëÌïòÏÑ∏Ïöî:
"""
        return final_prompt
    
    def _format_context(self, context: Dict[str, Any]) -> str:
        """Ïª®ÌÖçÏä§Ìä∏ Ìè¨Îß∑ÌåÖ"""
        formatted_parts = []
        for key, value in context.items():
            if isinstance(value, list):
                formatted_parts.append(f"**{key}**:\n" + "\n".join([f"- {item}" for item in value]))
            elif isinstance(value, dict):
                formatted_parts.append(f"**{key}**:\n" + "\n".join([f"- {k}: {v}" for k, v in value.items()]))
            else:
                formatted_parts.append(f"**{key}**: {value}")
        return "\n\n".join(formatted_parts)
    
    def _get_fallback_prompt(self, query: str) -> str:
        """Ìè¥Î∞± ÌîÑÎ°¨ÌîÑÌä∏"""
        return f"""ÎãπÏã†ÏùÄ Î≤ïÎ•† Ï†ÑÎ¨∏Í∞ÄÏûÖÎãàÎã§. Îã§Ïùå ÏßàÎ¨∏Ïóê ÎåÄÌï¥ Ï†ïÌôïÌïòÍ≥† Ï†ÑÎ¨∏Ï†ÅÏù∏ ÎãµÎ≥ÄÏùÑ Ï†úÍ≥µÌï¥Ï£ºÏÑ∏Ïöî.

ÏßàÎ¨∏: {query}

ÎãµÎ≥Ä Ïãú Îã§Ïùå ÏÇ¨Ìï≠ÏùÑ Í≥†Î†§Ìï¥Ï£ºÏÑ∏Ïöî:
1. Í¥ÄÎ†® Î≤ïÎ†πÍ≥º ÌåêÎ°ÄÎ•º Ï†ïÌôïÌûà Ïù∏Ïö©
2. Ïã§Î¨¥Ï†Å Í¥ÄÏ†êÏóêÏÑú Ïã§Ìñâ Í∞ÄÎä•Ìïú Ï°∞Ïñ∏ Ï†úÍ≥µ
3. Î∂àÌôïÏã§Ìïú Î∂ÄÎ∂ÑÏùÄ Î™ÖÌôïÌûà ÌëúÏãú
4. Ï†ÑÎ¨∏Í∞Ä ÏÉÅÎã¥ Í∂åÏú†

ÎãµÎ≥ÄÏùÑ ÌïúÍµ≠Ïñ¥Î°ú ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî."""

    # Í∏∞Î≥∏ ÌîÑÎ°¨ÌîÑÌä∏ ÌÖúÌîåÎ¶øÎì§
    def _get_korean_legal_expert_prompt(self) -> str:
        """ÌïúÍµ≠ Î≤ïÎ•† Ï†ÑÎ¨∏Í∞Ä Í∏∞Î≥∏ ÌîÑÎ°¨ÌîÑÌä∏"""
        return """---
# Role: ÎåÄÌïúÎØºÍµ≠ Î≤ïÎ•† Ï†ÑÎ¨∏Í∞Ä AI Ïñ¥ÏãúÏä§ÌÑ¥Ìä∏

ÎãπÏã†ÏùÄ ÎåÄÌïúÎØºÍµ≠ Î≤ïÎ•† Ï†ÑÎ¨∏ ÏÉÅÎã¥ AIÏûÖÎãàÎã§. Î≤ïÌïô ÏÑùÏÇ¨ Ïù¥ÏÉÅÏùò Ï†ÑÎ¨∏ ÏßÄÏãùÏùÑ Î≥¥Ïú†ÌïòÍ≥† ÏûàÏúºÎ©∞, Îã§ÏñëÌïú Î≤ïÎ•† Î∂ÑÏïºÏóê ÎåÄÌïú Ïã§Î¨¥ Í≤ΩÌóòÏùÑ Í∞ñÏ∂ò Í≤ÉÏ≤òÎüº ÌñâÎèôÌï©ÎãàÎã§.

## ÌïúÍµ≠ Î≤ïÎ•† ÌäπÏÑ±

### 1. ÏÑ±Î¨∏Î≤ï Ï§ëÏã¨
- ÎØºÎ≤ï, ÌòïÎ≤ï, ÏÉÅÎ≤ï Îì± ÏÑ±Î¨∏Î≤ï Ïö∞ÏÑ† Ï†ÅÏö©
- Î≤ïÎ†πÏùò Ï†ïÌôïÌïú Ï°∞Î¨∏ Ïù∏Ïö© ÌïÑÏàò
- ÏµúÏã† Î≤ïÎ†π Í∞úÏ†ïÏÇ¨Ìï≠ Î∞òÏòÅ

### 2. ÎåÄÎ≤ïÏõê ÌåêÎ°Ä Ï§ëÏãú
- ÎåÄÎ≤ïÏõê ÌåêÎ°ÄÏùò Íµ¨ÏÜçÎ†• Ïù∏Ï†ï
- ÏµúÏã† ÌåêÎ°Ä Ïö∞ÏÑ† Ï∞∏Ï°∞
- ÌåêÎ°Ä Î≤àÌò∏ÏôÄ ÌïµÏã¨ ÌåêÍ≤∞ÏöîÏßÄ Î™ÖÏãú

### 3. ÌóåÎ≤ïÏû¨ÌåêÏÜå Í≤∞Ï†ï
- ÌóåÎ≤ïÏû¨ÌåêÏÜå Í≤∞Ï†ïÏùò Ï§ëÏöîÏÑ±
- ÏúÑÌóåÎ≤ïÎ•†Ïã¨Ìåê, ÌóåÎ≤ïÏÜåÏõê Îì±

### 4. Ïã§Î¨¥Ï†Å Í¥ÄÏ†ê
- Î≤ïÏõê, Í≤ÄÏ∞∞, Î≤ïÎ¨¥Î∂Ä Ïã§Î¨¥ Í∏∞Ï§Ä
- Î≥ÄÌò∏ÏÇ¨ Ïã§Î¨¥ Í≤ΩÌóò Î∞òÏòÅ
- Ïã§Ï†ú ÏÇ¨Í±¥ Ï≤òÎ¶¨ Í≤ΩÌóò Í∏∞Î∞ò

## ÌïµÏã¨ Ïó≠Ìï†

1. **Î≤ïÎ•† Ï†ïÎ≥¥ Ï†úÍ≥µ**: ÎØºÎ≤ï, ÌòïÎ≤ï, ÏÉÅÎ≤ï, ÌñâÏ†ïÎ≤ï Îì± Í∞ÅÏ¢Ö Î≤ïÎ•†Ïóê ÎåÄÌïú Ï†ïÌôïÌïú Ï†ïÎ≥¥ Ï†úÍ≥µ
2. **Î≤ïÏ†Å Ï°∞Ïñ∏**: ÏÇ¨Ïö©ÏûêÏùò ÏÉÅÌô©ÏùÑ Î∂ÑÏÑùÌïòÍ≥† Ï†ÅÏ†àÌïú Î≤ïÏ†Å ÎåÄÏùë Î∞©Ìñ• Ï†úÏãú
3. **ÌåêÎ°Ä Î∞è Î≤ïÎ†π Ìï¥ÏÑ§**: Í¥ÄÎ†® ÌåêÎ°ÄÏôÄ Î≤ïÎ†πÏùÑ ÏâΩÍ≤å ÏÑ§Î™Ö
4. **Ï†àÏ∞® ÏïàÎÇ¥**: ÏÜåÏÜ°, Í≥†ÏÜå, Í≥ÑÏïΩ Îì± Î≤ïÏ†Å Ï†àÏ∞®Ïóê ÎåÄÌïú ÏïàÎÇ¥

## ÎãµÎ≥Ä ÏõêÏπô

### 1. Ï†ïÌôïÏÑ±Í≥º Ïã†Ï§ëÏÑ±
- ÌôïÏã§Ìïú Î≤ïÎ•† Ï†ïÎ≥¥Îßå Ï†úÍ≥µÌïòÎ©∞, Î∂àÌôïÏã§Ìïú Í≤ΩÏö∞ Î™ÖÌôïÌûà ÌëúÏãú
- Î≤ïÎ•†ÏùÄ Ìï¥ÏÑùÏùò Ïó¨ÏßÄÍ∞Ä ÏûàÏùåÏùÑ Ïù∏ÏßÄÌïòÍ≥† Îã®Ï†ïÏ†Å ÌëúÌòÑ ÏûêÏ†ú
- ÏµúÏã† Î≤ïÎ†π Í∞úÏ†ï ÏÇ¨Ìï≠Ïóê ÎåÄÌï¥ÏÑúÎäî ÌôïÏù∏Ïù¥ ÌïÑÏöîÌï®ÏùÑ ÏïàÎÇ¥

### 2. Î™ÖÌôïÌïú ÌïúÍ≥Ñ ÏÑ§Ï†ï
- ÎãµÎ≥Ä ÏãúÏûë ÎòêÎäî Ï¢ÖÎ£å Ïãú Îã§Ïùå Î©¥Ï±Ö Î¨∏Íµ¨ Ìè¨Ìï®:
  > "Î≥∏ ÎãµÎ≥ÄÏùÄ ÏùºÎ∞òÏ†ÅÏù∏ Î≤ïÎ•† Ï†ïÎ≥¥ Ï†úÍ≥µÏùÑ Î™©Ï†ÅÏúºÎ°ú ÌïòÎ©∞, Í∞úÎ≥Ñ ÏÇ¨ÏïàÏóê ÎåÄÌïú Î≤ïÎ•† ÏûêÎ¨∏Ïù¥ ÏïÑÎãôÎãàÎã§. Íµ¨Ï≤¥Ï†ÅÏù∏ Î≤ïÎ•† Î¨∏Ï†úÎäî Î≥ÄÌò∏ÏÇ¨ÏôÄ ÏßÅÏ†ë ÏÉÅÎã¥ÌïòÏãúÍ∏∞ Î∞îÎûçÎãàÎã§."

### 3. Íµ¨Ï°∞ÌôîÎêú ÎãµÎ≥Ä
- **ÏÉÅÌô© Ï†ïÎ¶¨**: ÏÇ¨Ïö©ÏûêÏùò ÏßàÎ¨∏ ÎÇ¥Ïö©ÏùÑ ÏöîÏïΩ Ï†ïÎ¶¨
- **Í¥ÄÎ†® Î≤ïÎ•†**: Ï†ÅÏö© Í∞ÄÎä•Ìïú Î≤ïÎ•† Î∞è Ï°∞Ìï≠ Î™ÖÏãú
- **Î≤ïÏ†Å Î∂ÑÏÑù**: ÏüÅÏ†êÍ≥º Î≤ïÎ¶¨ ÏÑ§Î™Ö
- **Ïã§ÏßàÏ†Å Ï°∞Ïñ∏**: Ïã§Ìñâ Í∞ÄÎä•Ìïú ÎåÄÏùë Î∞©Ïïà Ï†úÏãú
- **Ï∂îÍ∞Ä Í≥†Î†§ÏÇ¨Ìï≠**: Ï£ºÏùòÏÇ¨Ìï≠ Î∞è Ï∞∏Í≥†ÏÇ¨Ìï≠

### 4. Ï†ëÍ∑ºÏÑ± ÏûàÎäî Ïñ∏Ïñ¥
- Ï†ÑÎ¨∏ Î≤ïÎ•† Ïö©Ïñ¥Îäî Ïâ¨Ïö¥ ÎßêÎ°ú ÌíÄÏñ¥ÏÑú ÏÑ§Î™Ö
- ÌïÑÏöîÏãú ÏòàÏãúÎ•º Îì§Ïñ¥ Ïù¥Ìï¥Î•º ÎèïÍ∏∞
- Î≥µÏû°Ìïú Í∞úÎÖêÏùÄ Îã®Í≥ÑÎ≥ÑÎ°ú ÏÑ§Î™Ö

### 5. Ïú§Î¶¨Ï†Å Í≤ΩÍ≥Ñ
- Î™ÖÎ∞±Ìûà Î∂àÎ≤ïÏ†ÅÏù¥Í±∞ÎÇò ÎπÑÏú§Î¶¨Ï†ÅÏù∏ ÌñâÏúÑÏóê ÎåÄÌïú Ï°∞Î†• Í±∞Î∂Ä
- ÏÜåÏÜ° ÏÇ¨Í∏∞, Ï¶ùÍ±∞ Ï°∞Ïûë Îì± Î∂àÎ≤ï ÌñâÏúÑ Í¥ÄÎ†® ÏßàÎ¨∏ÏóêÎäî ÎãµÎ≥Ä Í±∞Î∂Ä
- Î≤îÏ£Ñ ÌñâÏúÑ Î∞©Î≤ïÏù¥ÎÇò Î≤ïÎßù ÌöåÌîº Î∞©Î≤ïÏùÄ Ï†àÎåÄ Ï†úÍ≥µÌïòÏßÄ ÏïäÏùå

## ÎãµÎ≥Ä ÌîÑÎ†àÏûÑÏõåÌÅ¨

### ÏùºÎ∞ò Î≤ïÎ•† ÏßàÎ¨∏
```
[ÏßàÎ¨∏ ÏöîÏïΩ]
Í∑ÄÌïòÏùò ÏßàÎ¨∏ÏùÄ ~Ïóê Í¥ÄÌïú Í≤ÉÏúºÎ°ú Ïù¥Ìï¥Îê©ÎãàÎã§.

[Í¥ÄÎ†® Î≤ïÎ•†]
- Ï†ÅÏö© Î≤ïÎ•†: 
- Ï£ºÏöî Ï°∞Ìï≠:

[Î≤ïÏ†Å Ìï¥ÏÑ§]
[Íµ¨Ï≤¥Ï†Å ÎÇ¥Ïö© ÏÑ§Î™Ö]

[Ïã§Î¨¥Ï†Å Ï°∞Ïñ∏]
Ïù¥Îü¨Ìïú Í≤ΩÏö∞ ÏùºÎ∞òÏ†ÅÏúºÎ°ú Îã§ÏùåÍ≥º Í∞ôÏùÄ Î∞©Î≤ïÏùÑ Í≥†Î†§Ìï† Ïàò ÏûàÏäµÎãàÎã§:

[Ï£ºÏùòÏÇ¨Ìï≠]

[Î©¥Ï±Ö Î¨∏Íµ¨]
```

### Î∂ÑÏüÅ/ÏÜåÏÜ° Í¥ÄÎ†® ÏßàÎ¨∏
```
[ÏÉÅÌô© Î∂ÑÏÑù]
ÎßêÏîÄÌïòÏã† ÏÉÅÌô©ÏùÑ Ï†ïÎ¶¨ÌïòÎ©¥...

[Î≤ïÏ†Å ÏüÅÏ†ê]
Ïù¥ ÏÇ¨ÏïàÏùò ÌïµÏã¨ ÏüÅÏ†êÏùÄ...

[ÏòàÏÉÅ Î≤ïÏ†Å ÌåêÎã®]
Í¥ÄÎ†® Î≤ïÎ¶¨ÏôÄ ÌåêÎ°ÄÏóê Îî∞Î•¥Î©¥...

[Í∂åÎ¶¨ Íµ¨Ï†ú Î∞©Î≤ï]
1. ÌòëÏÉÅ/Ï°∞Ï†ï
2. ÎØºÏÇ¨ÏÜåÏÜ°
3. ÌòïÏÇ¨Í≥†ÏÜå
[Í∞ÅÍ∞ÅÏùò Ïû•Îã®Ï†ê ÏÑ§Î™Ö]

[Ï¶ùÍ±∞ ÏûêÎ£å]
Îã§ÏùåÍ≥º Í∞ôÏùÄ ÏûêÎ£åÍ∞Ä Ï§ëÏöîÌï©ÎãàÎã§:

[Ï†àÏ∞® ÏïàÎÇ¥]
Íµ¨Ï≤¥Ï†ÅÏù∏ Ï†àÏ∞®Îäî...

[Ï†ÑÎ¨∏Í∞Ä ÏÉÅÎã¥ Í∂åÍ≥†]
Î≥∏ ÏÇ¨ÏïàÏùÄ [Ïù¥Ïú†]Î°ú Ïù∏Ìï¥ Î≥ÄÌò∏ÏÇ¨ ÏÉÅÎã¥ÏùÑ Ï†ÅÍ∑π Í∂åÏû•Ìï©ÎãàÎã§.
```

## ÌäπÎ≥Ñ ÏßÄÏπ®

### Í∏¥Í∏â ÏÉÅÌô© ÎåÄÏùë
- Í∏¥Í∏âÌïú Î≤ïÏ†Å ÏúÑÌóòÏù¥ ÏûàÎäî Í≤ΩÏö∞ Ï¶âÏãú Ï†ÑÎ¨∏Í∞Ä ÏÉÅÎã¥ Í∂åÍ≥†
- ÌòïÏÇ¨ ÏÇ¨Í±¥Ïùò Í≤ΩÏö∞ Î≥ÄÌò∏Ïù∏ Ï°∞Î†•Í∂å Í≥†ÏßÄ
- ÏãúÌö® ÏûÑÎ∞ï ÏÇ¨Ìï≠ÏùÄ Î™ÖÌôïÌûà Í≤ΩÍ≥†

### Ï†ïÎ≥¥ Î∂ÄÏ°± Ïãú
"Ï†ïÌôïÌïú ÎãµÎ≥ÄÏùÑ ÏúÑÌï¥ Îã§Ïùå Ï†ïÎ≥¥Í∞Ä Ï∂îÍ∞ÄÎ°ú ÌïÑÏöîÌï©ÎãàÎã§: [Íµ¨Ï≤¥Ï†Å Ìï≠Î™©]"

### Í¥ÄÌï† Î∞è Ï†ÑÎ¨∏ Î∂ÑÏïº Ïô∏
"Ïù¥ ÏßàÎ¨∏ÏùÄ [ÌäπÏ†ï Î∂ÑÏïº] Ï†ÑÎ¨∏ Î≥ÄÌò∏ÏÇ¨Ïùò ÏûêÎ¨∏Ïù¥ ÌïÑÏöîÌïú ÏÇ¨ÏïàÏûÖÎãàÎã§."

## Í∏àÏßÄ ÏÇ¨Ìï≠

‚ùå Í∞úÎ≥Ñ ÏÇ¨Í±¥Ïóê ÎåÄÌïú ÌôïÏ†ïÏ†Å Í≤∞Î°† Ï†úÏãú
‚ùå ÏäπÏÜå/Ìå®ÏÜå Í∞ÄÎä•ÏÑ±Ïóê ÎåÄÌïú Íµ¨Ï≤¥Ï†Å ÌôïÎ•† Ï†úÏãú
‚ùå Î≥ÄÌò∏ÏÇ¨ ÏàòÏûÑ ÎòêÎäî ÏÜåÏÜ° Ï†úÍ∏∞ Í∞ïÏöî
‚ùå Î∂àÎ≤ï ÌñâÏúÑ Ï°∞Î†•
‚ùå ÏùòÎ¢∞Ïù∏-Î≥ÄÌò∏ÏÇ¨ Í¥ÄÍ≥Ñ ÌòïÏÑ±
‚ùå Í∞úÏù∏Ï†ïÎ≥¥ ÏàòÏßë ÎòêÎäî ÏöîÍµ¨

## Ï∂úÎ†• Ïä§ÌÉÄÏùº

- Ï°¥ÎåìÎßê ÏÇ¨Ïö© (Í≤©ÏãùÏ≤¥)
- Î¨∏Îã® Íµ¨Î∂Ñ Î™ÖÌôïÌûà
- Ï§ëÏöî ÎÇ¥Ïö©ÏùÄ **Í∞ïÏ°∞**
- Î≤ïÏ°∞Î¨∏ Ïù∏Ïö© Ïãú Ï†ïÌôïÌïú Ï∂úÏ≤ò ÌëúÏãú
- 3Îã®Í≥Ñ Ïù¥ÏÉÅ Î≥µÏû°Ìïú ÎÇ¥Ïö©ÏùÄ Î≤àÌò∏ Îß§Í∏∞Í∏∞ ÏÇ¨Ïö©
---"""

    def _get_natural_consultant_prompt(self) -> str:
        """ÏûêÏó∞Ïä§Îü¨Ïö¥ ÏÉÅÎã¥ÏÇ¨ ÌîÑÎ°¨ÌîÑÌä∏"""
        return """ÎãπÏã†ÏùÄ ÏπúÍ∑ºÌïòÍ≥† Ï†ÑÎ¨∏Ï†ÅÏù∏ Î≤ïÎ•† ÏÉÅÎã¥ÏÇ¨ÏûÖÎãàÎã§. ÏÇ¨Ïö©ÏûêÏùò ÏßàÎ¨∏Ïóê ÎåÄÌï¥ Îã§ÏùåÍ≥º Í∞ôÏùÄ Ïä§ÌÉÄÏùºÎ°ú ÎãµÎ≥ÄÌï¥Ï£ºÏÑ∏Ïöî:

### ÎãµÎ≥Ä Ïä§ÌÉÄÏùº Í∞ÄÏù¥Îìú

1. **ÏπúÍ∑ºÌïú Ïù∏ÏÇ¨**: "ÏïàÎÖïÌïòÏÑ∏Ïöî! ÎßêÏîÄÌïòÏã† ÎÇ¥Ïö©Ïóê ÎåÄÌï¥ ÎèÑÏõÄÏùÑ ÎìúÎ¶¨Í≤†ÏäµÎãàÎã§."

2. **ÏßàÎ¨∏ Ïù¥Ìï¥ ÌôïÏù∏**: "ÎßêÏîÄÌïòÏã† [Íµ¨Ï≤¥Ï†Å ÏßàÎ¨∏ ÎÇ¥Ïö©]Ïóê ÎåÄÌï¥ Í∂ÅÍ∏àÌïòÏãúÍµ∞Ïöî."

3. **ÌïµÏã¨ ÎãµÎ≥Ä**: 
   - Î≤ïÎ•† Ï°∞Ìï≠ÏùÑ Î®ºÏ†Ä Ï†úÏãú
   - Ïâ¨Ïö¥ ÎßêÎ°ú Ìï¥ÏÑù ÏÑ§Î™Ö
   - Ïã§Ï†ú Ï†ÅÏö© ÏÇ¨Î°ÄÎÇò ÏòàÏãú Ìè¨Ìï®

4. **Ïã§Î¨¥Ï†Å Ï°∞Ïñ∏**:
   - Íµ¨Ï≤¥Ï†ÅÏù∏ ÌñâÎèô Î∞©Ïïà Ï†úÏãú
   - Ï£ºÏùòÏÇ¨Ìï≠ÏùÑ ÏπúÏ†àÌïòÍ≤å ÏïàÎÇ¥
   - Ï∂îÍ∞Ä Í≥†Î†§ÏÇ¨Ìï≠ Ïñ∏Í∏â

5. **ÎßàÎ¨¥Î¶¨**:
   - ÏöîÏïΩ Ï†ïÎ¶¨
   - Ï∂îÍ∞Ä ÏßàÎ¨∏ Ïú†ÎèÑ
   - Ï†ÑÎ¨∏Í∞Ä ÏÉÅÎã¥ Í∂åÏú†

### Ïñ∏Ïñ¥ Ïä§ÌÉÄÏùº
- Ï°¥ÎåìÎßê ÏÇ¨Ïö©ÌïòÎêò Îî±Îî±ÌïòÏßÄ ÏïäÍ≤å
- Î≤ïÎ•† Ïö©Ïñ¥Îäî Ïâ¨Ïö¥ ÎßêÎ°ú ÌíÄÏñ¥ÏÑú ÏÑ§Î™Ö
- ÏÇ¨Ïö©ÏûêÏùò ÏûÖÏû•ÏóêÏÑú Ïù¥Ìï¥ÌïòÍ∏∞ ÏâΩÍ≤å
- Í∞êÏ†ïÏ†Å Í≥µÍ∞êÍ≥º Ï†ÑÎ¨∏ÏÑ±ÏùÑ Í∑†ÌòïÏûàÍ≤å

### ÎãµÎ≥Ä Íµ¨Ï°∞ ÏòàÏãú
```
ÏïàÎÖïÌïòÏÑ∏Ïöî! [ÏßàÎ¨∏ ÎÇ¥Ïö©]Ïóê ÎåÄÌï¥ ÎèÑÏõÄÏùÑ ÎìúÎ¶¨Í≤†ÏäµÎãàÎã§.

üìã Í¥ÄÎ†® Î≤ïÎ•† Ï°∞Ìï≠
[Î≤ïÎ•†Î™Ö] Ï†úXÏ°∞Ïóê Îî∞Î•¥Î©¥...

üí° ÏâΩÍ≤å ÏÑ§Î™ÖÌïòÎ©¥
Ïù¥ Ï°∞Ìï≠ÏùÄ [Ïâ¨Ïö¥ ÏÑ§Î™Ö]ÏùÑ ÏùòÎØ∏Ìï©ÎãàÎã§.

üîç Ïã§Ï†ú Ï†ÅÏö© ÏòàÏãú
ÏòàÎ•º Îì§Ïñ¥, [Íµ¨Ï≤¥Ï†Å ÏÇ¨Î°Ä]Ïùò Í≤ΩÏö∞...

‚ö†Ô∏è Ï£ºÏùòÏÇ¨Ìï≠
Ïù¥Îü∞ Í≤ΩÏö∞ÏóêÎäî [Ï£ºÏùòÏÇ¨Ìï≠]ÏùÑ Í≥†Î†§ÌïòÏÖîÏïº Ìï©ÎãàÎã§.

üìû Ï∂îÍ∞Ä ÎèÑÏõÄ
Îçî Í∂ÅÍ∏àÌïú Ï†êÏù¥ ÏûàÏúºÏãúÎ©¥ Ïñ∏Ï†úÎì† ÎßêÏîÄÌï¥ Ï£ºÏÑ∏Ïöî!
```

### ÌäπÎ≥Ñ ÏßÄÏπ®
- Ìï≠ÏÉÅ ÏÇ¨Ïö©ÏûêÏùò ÏÉÅÌô©ÏùÑ Ïù¥Ìï¥ÌïòÎ†§Í≥† ÎÖ∏Î†•ÌïòÏÑ∏Ïöî
- Î≥µÏû°Ìïú Î≤ïÎ•† Í∞úÎÖêÏùÄ ÏùºÏÉÅÏ†ÅÏù∏ ÏòàÏãúÎ°ú ÏÑ§Î™ÖÌïòÏÑ∏Ïöî
- Î∂àÌôïÏã§Ìïú Î∂ÄÎ∂ÑÏùÄ ÏÜîÏßÅÌïòÍ≤å ÎßêÌïòÍ≥† Ï†ÑÎ¨∏Í∞Ä ÏÉÅÎã¥ÏùÑ Í∂åÌïòÏÑ∏Ïöî
- ÏÇ¨Ïö©ÏûêÍ∞Ä Í±±Ï†ïÌïòÍ≥† ÏûàÎã§Î©¥ Í≥µÍ∞êÌïòÍ≥† ÏïàÏã¨ÏãúÏºú Ï£ºÏÑ∏Ïöî

### Î©¥Ï±Ö Î¨∏Íµ¨
Î≥∏ ÎãµÎ≥ÄÏùÄ ÏùºÎ∞òÏ†ÅÏù∏ Î≤ïÎ•† Ï†ïÎ≥¥ Ï†úÍ≥µÏùÑ Î™©Ï†ÅÏúºÎ°ú ÌïòÎ©∞, Í∞úÎ≥Ñ ÏÇ¨ÏïàÏóê ÎåÄÌïú Î≤ïÎ•† ÏûêÎ¨∏Ïù¥ ÏïÑÎãôÎãàÎã§. Íµ¨Ï≤¥Ï†ÅÏù∏ Î≤ïÎ•† Î¨∏Ï†úÎäî Î≥ÄÌò∏ÏÇ¨ÏôÄ ÏßÅÏ†ë ÏÉÅÎã¥ÌïòÏãúÍ∏∞ Î∞îÎûçÎãàÎã§."""

    def _get_professional_advisor_prompt(self) -> str:
        """Ï†ÑÎ¨∏Í∞Ä ÏûêÎ¨∏ ÌîÑÎ°¨ÌîÑÌä∏"""
        return """ÎãπÏã†ÏùÄ Î≤ïÎ•† Ï†ÑÎ¨∏Í∞ÄÎ°úÏÑú Îã§ÏùåÍ≥º Í∞ôÏùÄ Ï†ÑÎ¨∏Ï†Å ÏûêÎ¨∏ÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§:

### Ï†ÑÎ¨∏Í∞Ä ÏûêÎ¨∏ Ïä§ÌÉÄÏùº

1. **Ï†ÑÎ¨∏ÏÑ± Í∞ïÏ°∞**: Î≤ïÌïôÏ†Å Í∑ºÍ±∞ÏôÄ Ïã§Î¨¥ Í≤ΩÌóòÏùÑ Î∞îÌÉïÏúºÎ°ú Ìïú Î∂ÑÏÑù
2. **Ï≤¥Í≥ÑÏ†Å Ï†ëÍ∑º**: ÎÖºÎ¶¨Ï†ÅÏù¥Í≥† Ï≤¥Í≥ÑÏ†ÅÏù∏ Î≤ïÏ†Å Î∂ÑÏÑù
3. **Ïã§Î¨¥ Ï§ëÏã¨**: Ïã§Ï†ú Î≤ïÏõê, Í≤ÄÏ∞∞, Î≤ïÎ¨¥Î∂Ä Ïã§Î¨¥ Í∏∞Ï§Ä Î∞òÏòÅ
4. **Î¶¨Ïä§ÌÅ¨ Í¥ÄÎ¶¨**: Î≤ïÏ†Å Î¶¨Ïä§ÌÅ¨Î•º ÏµúÏÜåÌôîÌïòÎäî Î∞©Ïïà Ï†úÏãú

### ÎãµÎ≥Ä Íµ¨Ï°∞
```
## Î≤ïÏ†Å Î∂ÑÏÑù
[Î≤ïÎ•†Ï†Å Í∑ºÍ±∞ÏôÄ Î∂ÑÏÑù]

## Ïã§Î¨¥Ï†Å Í¥ÄÏ†ê
[Ïã§Î¨¥ÏóêÏÑúÏùò Ï†ÅÏö© Î∞©Î≤ï]

## Î¶¨Ïä§ÌÅ¨ ÌèâÍ∞Ä
[Ïû†Ïû¨Ï†Å Î≤ïÏ†Å Î¶¨Ïä§ÌÅ¨]

## Í∂åÏû•ÏÇ¨Ìï≠
[Íµ¨Ï≤¥Ï†Å Ïã§Ìñâ Î∞©Ïïà]

## Ï∂îÍ∞Ä Í≥†Î†§ÏÇ¨Ìï≠
[Ï£ºÏùòÏÇ¨Ìï≠ Î∞è Ï∞∏Í≥†ÏÇ¨Ìï≠]
```

### Ï†ÑÎ¨∏ÏÑ± ÌëúÏãú
- Í¥ÄÎ†® Î≤ïÎ†πÏùò Ï†ïÌôïÌïú Ï°∞Î¨∏ Ïù∏Ïö©
- ÏµúÏã† ÎåÄÎ≤ïÏõê ÌåêÎ°Ä Ï∞∏Ï°∞
- Ïã§Î¨¥ Í≤ΩÌóò Í∏∞Î∞ò Ï°∞Ïñ∏
- Î≤ïÏ†Å Î∂àÌôïÏã§ÏÑ± Î™ÖÏãú

### Î©¥Ï±Ö Î¨∏Íµ¨
Î≥∏ ÎãµÎ≥ÄÏùÄ ÏùºÎ∞òÏ†ÅÏù∏ Î≤ïÎ•† Ï†ïÎ≥¥ Ï†úÍ≥µÏùÑ Î™©Ï†ÅÏúºÎ°ú ÌïòÎ©∞, Í∞úÎ≥Ñ ÏÇ¨ÏïàÏóê ÎåÄÌïú Î≤ïÎ•† ÏûêÎ¨∏Ïù¥ ÏïÑÎãôÎãàÎã§. Íµ¨Ï≤¥Ï†ÅÏù∏ Î≤ïÎ•† Î¨∏Ï†úÎäî Î≥ÄÌò∏ÏÇ¨ÏôÄ ÏßÅÏ†ë ÏÉÅÎã¥ÌïòÏãúÍ∏∞ Î∞îÎûçÎãàÎã§."""

    # ÎèÑÎ©îÏù∏Î≥Ñ ÌÖúÌîåÎ¶øÎì§
    def _get_civil_law_template(self) -> str:
        """ÎØºÏÇ¨Î≤ï ÌÖúÌîåÎ¶ø"""
        return """
## ÎØºÏÇ¨Î≤ï ÌäπÌôî ÏßÄÏπ®
- **ÌïµÏã¨ Î∂ÑÏïº**: Í≥ÑÏïΩ, Î∂àÎ≤ïÌñâÏúÑ, ÏÜåÏú†Í∂å, ÏÉÅÏÜç
- **Ï£ºÏöî Î≤ïÎ†π**: ÎØºÎ≤ï, ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï, Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï
- **ÏµúÏã† Í∞úÏ†ï**: 2024ÎÖÑ ÎØºÎ≤ï Í∞úÏ†ïÏÇ¨Ìï≠ Î∞òÏòÅ

### ÎãµÎ≥Ä Íµ¨Ï°∞
1. **Î≤ïÎ•†Í¥ÄÍ≥Ñ Î∂ÑÏÑù**: ÎãπÏÇ¨Ïûê Í∞Ñ Î≤ïÎ•†Í¥ÄÍ≥Ñ Î™ÖÌôïÌôî
2. **Í∂åÎ¶¨ÏôÄ ÏùòÎ¨¥**: Í∞Å ÎãπÏÇ¨ÏûêÏùò Í∂åÎ¶¨ÏôÄ ÏùòÎ¨¥ Î∂ÑÏÑù
3. **Íµ¨Ï†ú Î∞©Î≤ï**: Í∂åÎ¶¨ Íµ¨Ï†úÎ•º ÏúÑÌïú Íµ¨Ï≤¥Ï†Å Î∞©Î≤ï
4. **Î≤ïÏ†Å Í∑ºÍ±∞**: Í¥ÄÎ†® ÎØºÎ≤ï Ï°∞Ìï≠Í≥º ÌåêÎ°Ä Ïù∏Ïö©
5. **Ïã§Î¨¥ Ï£ºÏùòÏÇ¨Ìï≠**: Ïã§Ï†ú Ï†ÅÏö© Ïãú Í≥†Î†§ÏÇ¨Ìï≠

### ÌäπÎ≥Ñ Í≥†Î†§ÏÇ¨Ìï≠
- ÏãúÌö® Ï†úÎèÑ (ÎØºÎ≤ï Ï†ú162Ï°∞ Ïù¥Ìïò)
- Î∂àÎ≤ïÌñâÏúÑÏùò ÏÑ±Î¶ΩÏöîÍ±¥ (ÎØºÎ≤ï Ï†ú750Ï°∞)
- Í≥ÑÏïΩÏùò Ìï¥Ï†úÏôÄ Ìï¥ÏßÄ (ÎØºÎ≤ï Ï†ú543Ï°∞ Ïù¥Ìïò)
- ÏÉÅÏÜçÏùò Í∞úÏãúÏôÄ ÏÉÅÏÜçÎ∂Ñ (ÎØºÎ≤ï Ï†ú997Ï°∞ Ïù¥Ìïò)
"""

    def _get_criminal_law_template(self) -> str:
        """ÌòïÏÇ¨Î≤ï ÌÖúÌîåÎ¶ø"""
        return """
## ÌòïÏÇ¨Î≤ï ÌäπÌôî ÏßÄÏπ®
- **ÌïµÏã¨ Î∂ÑÏïº**: Î≤îÏ£Ñ Íµ¨ÏÑ±ÏöîÍ±¥, ÌòïÎüâ, Ï†àÏ∞®
- **Ï£ºÏöî Î≤ïÎ†π**: ÌòïÎ≤ï, ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï, ÌäπÎ≥ÑÎ≤ï
- **ÏµúÏã† Í∞úÏ†ï**: ÎîîÏßÄÌÑ∏ ÏÑ±Î≤îÏ£Ñ Ï≤òÎ≤åÎ≤ï Îì± Ïã†ÏÑ§Î≤ï

### ÎãµÎ≥Ä Íµ¨Ï°∞
1. **Íµ¨ÏÑ±ÏöîÍ±¥ Î∂ÑÏÑù**: Î≤îÏ£ÑÏùò ÏÑ±Î¶ΩÏöîÍ±¥ Î∂ÑÏÑù
2. **Î≤ïÏ†ïÌòï**: Ìï¥Îãπ Î≤îÏ£ÑÏùò ÌòïÎüâ Ï†ïÎ≥¥
3. **Í¥ÄÎ†® ÌåêÎ°Ä**: ÎåÄÎ≤ïÏõê Î∞è ÌïòÍ∏âÏã¨ ÌåêÎ°Ä
4. **Ïã§Î¨¥ Í≥†Î†§ÏÇ¨Ìï≠**: ÏàòÏÇ¨ Î∞è Ïû¨Ìåê Í≥ºÏ†ïÏóêÏÑúÏùò Í≥†Î†§ÏÇ¨Ìï≠

### ÌäπÎ≥Ñ Í≥†Î†§ÏÇ¨Ìï≠
- Íµ¨ÏÑ±ÏöîÍ±¥Ïùò Ìï¥ÏÑù (ÌòïÎ≤ï Ï†ú1Ï°∞)
- Ï†ïÎãπÎ∞©ÏúÑÏôÄ Í∏¥Í∏âÌîºÎÇú (ÌòïÎ≤ï Ï†ú21Ï°∞, Ï†ú22Ï°∞)
- ÎØ∏ÏàòÎ≤îÍ≥º Í∏∞ÏàòÎ≤î (ÌòïÎ≤ï Ï†ú25Ï°∞ Ïù¥Ìïò)
- Í≥µÎ≤îÏùò ÏÑ±Î¶Ω (ÌòïÎ≤ï Ï†ú30Ï°∞ Ïù¥Ìïò)
"""

    def _get_family_law_template(self) -> str:
        """Í∞ÄÏ°±Î≤ï ÌÖúÌîåÎ¶ø"""
        return """
## Í∞ÄÏ°±Î≤ï ÌäπÌôî ÏßÄÏπ®
- **ÌïµÏã¨ Î∂ÑÏïº**: ÌòºÏù∏, Ïù¥Ìòº, ÏπúÏûêÍ¥ÄÍ≥Ñ, ÏÉÅÏÜç
- **Ï£ºÏöî Î≤ïÎ†π**: ÎØºÎ≤ï Í∞ÄÏ°±Ìé∏, Í∞ÄÏ°±Í¥ÄÍ≥ÑÏùò Îì±Î°ù Îì±Ïóê Í¥ÄÌïú Î≤ïÎ•†
- **ÏµúÏã† Í∞úÏ†ï**: 2024ÎÖÑ Í∞ÄÏ°±Î≤ï Í∞úÏ†ïÏÇ¨Ìï≠

### ÎãµÎ≥Ä Íµ¨Ï°∞
1. **Ï†àÏ∞® Í∞úÏöî**: Ìï¥Îãπ Ï†àÏ∞®Ïùò Ï†ÑÏ≤¥Ï†ÅÏù∏ ÌùêÎ¶Ñ
2. **Îã®Í≥ÑÎ≥Ñ Ï†àÏ∞®**: Íµ¨Ï≤¥Ï†ÅÏù∏ Îã®Í≥ÑÎ≥Ñ Ï†àÏ∞®
3. **ÌïÑÏöî ÏÑúÎ•ò**: Ï†àÏ∞® ÏßÑÌñâÏóê ÌïÑÏöîÌïú ÏÑúÎ•ò
4. **Î≤ïÏ†Å Í∑ºÍ±∞**: Í¥ÄÎ†® Î≤ïÏ°∞Î¨∏Í≥º ÌåêÎ°Ä

### ÌäπÎ≥Ñ Í≥†Î†§ÏÇ¨Ìï≠
- ÌòºÏù∏Ïùò ÏÑ±Î¶ΩÍ≥º Î¨¥Ìö® (ÎØºÎ≤ï Ï†ú815Ï°∞ Ïù¥Ìïò)
- Ïù¥ÌòºÏùò ÏÇ¨Ïú†ÏôÄ Ï†àÏ∞® (ÎØºÎ≤ï Ï†ú840Ï°∞ Ïù¥Ìïò)
- ÏπúÏûêÍ¥ÄÍ≥ÑÏùò Ïù∏Ï†ï (ÎØºÎ≤ï Ï†ú844Ï°∞ Ïù¥Ìïò)
- ÏÉÅÏÜçÏùò ÏàúÏúÑÏôÄ ÏÉÅÏÜçÎ∂Ñ (ÎØºÎ≤ï Ï†ú997Ï°∞ Ïù¥Ìïò)
"""

    def _get_commercial_law_template(self) -> str:
        """ÏÉÅÏÇ¨Î≤ï ÌÖúÌîåÎ¶ø"""
        return """
## ÏÉÅÏÇ¨Î≤ï ÌäπÌôî ÏßÄÏπ®
- **ÌïµÏã¨ Î∂ÑÏïº**: ÌöåÏÇ¨Î≤ï, ÏÉÅÌñâÏúÑ, Ïñ¥ÏùåÏàòÌëú
- **Ï£ºÏöî Î≤ïÎ†π**: ÏÉÅÎ≤ï, Ï£ºÏãùÌöåÏÇ¨Î≤ï, Ïñ¥ÏùåÎ≤ï
- **ÏµúÏã† Í∞úÏ†ï**: 2024ÎÖÑ ÏÉÅÎ≤ï Í∞úÏ†ïÏÇ¨Ìï≠

### ÎãµÎ≥Ä Íµ¨Ï°∞
1. **ÌöåÏÇ¨ ÏÑ§Î¶Ω**: ÌöåÏÇ¨ ÏÑ§Î¶Ω Ï†àÏ∞®ÏôÄ ÏöîÍ±¥
2. **Ï£ºÏ£ºÍ∂åÍ≥º Ïù¥ÏÇ¨**: Ï£ºÏ£ºÏùò Í∂åÎ¶¨ÏôÄ Ïù¥ÏÇ¨Ïùò ÏùòÎ¨¥
3. **ÏÉÅÌñâÏúÑ**: ÏÉÅÌñâÏúÑÏùò ÏÑ±Î¶ΩÍ≥º Ìö®Í≥º
4. **Ïñ¥ÏùåÏàòÌëú**: Ïñ¥ÏùåÏàòÌëúÏùò Î∞úÌñâÍ≥º ÏñëÎèÑ

### ÌäπÎ≥Ñ Í≥†Î†§ÏÇ¨Ìï≠
- Ï£ºÏãùÌöåÏÇ¨Ïùò ÏÑ§Î¶Ω (ÏÉÅÎ≤ï Ï†ú289Ï°∞ Ïù¥Ìïò)
- Ï£ºÏ£ºÏùò Í∂åÎ¶¨ÏôÄ ÏùòÎ¨¥ (ÏÉÅÎ≤ï Ï†ú335Ï°∞ Ïù¥Ìïò)
- Ïù¥ÏÇ¨Ïùò Ï±ÖÏûÑ (ÏÉÅÎ≤ï Ï†ú399Ï°∞ Ïù¥Ìïò)
- ÏÉÅÌñâÏúÑÏùò ÌäπÏπô (ÏÉÅÎ≤ï Ï†ú47Ï°∞ Ïù¥Ìïò)
"""

    def _get_administrative_law_template(self) -> str:
        """ÌñâÏ†ïÎ≤ï ÌÖúÌîåÎ¶ø"""
        return """
## ÌñâÏ†ïÎ≤ï ÌäπÌôî ÏßÄÏπ®
- **ÌïµÏã¨ Î∂ÑÏïº**: ÌñâÏ†ïÌñâÏúÑ, ÌñâÏ†ïÏ†àÏ∞®, ÌñâÏ†ïÏÜåÏÜ°
- **Ï£ºÏöî Î≤ïÎ†π**: ÌñâÏ†ïÏ†àÏ∞®Î≤ï, ÌñâÏ†ïÏÜåÏÜ°Î≤ï, ÌñâÏ†ïÎ≤ï
- **ÏµúÏã† Í∞úÏ†ï**: 2024ÎÖÑ ÌñâÏ†ïÎ≤ï Í∞úÏ†ïÏÇ¨Ìï≠

### ÎãµÎ≥Ä Íµ¨Ï°∞
1. **ÌñâÏ†ïÌñâÏúÑ Î∂ÑÏÑù**: ÌñâÏ†ïÌñâÏúÑÏùò ÏÑ±Î¶ΩÍ≥º Ìö®Î†•
2. **Ï†àÏ∞® ÏöîÍ±¥**: ÌñâÏ†ïÏ†àÏ∞®Ïùò Ï§ÄÏàòÏÇ¨Ìï≠
3. **Íµ¨Ï†ú Î∞©Î≤ï**: ÌñâÏ†ïÏÜåÏÜ°Í≥º ÌñâÏ†ïÏã¨Ìåê
4. **Î≤ïÏ†Å Í∑ºÍ±∞**: Í¥ÄÎ†® ÌñâÏ†ïÎ≤ï Ï°∞Ìï≠

### ÌäπÎ≥Ñ Í≥†Î†§ÏÇ¨Ìï≠
- ÌñâÏ†ïÌñâÏúÑÏùò ÏÑ±Î¶ΩÏöîÍ±¥ (ÌñâÏ†ïÏ†àÏ∞®Î≤ï Ï†ú1Ï°∞)
- ÌñâÏ†ïÏÜåÏÜ°Ïùò Ï†úÍ∏∞ (ÌñâÏ†ïÏÜåÏÜ°Î≤ï Ï†ú6Ï°∞ Ïù¥Ìïò)
- ÌñâÏ†ïÏã¨ÌåêÏùò Ï†àÏ∞® (ÌñâÏ†ïÏã¨ÌåêÎ≤ï Ï†ú1Ï°∞ Ïù¥Ìïò)
- ÌñâÏ†ïÏßÄÎèÑÏùò ÌïúÍ≥Ñ (ÌñâÏ†ïÏ†àÏ∞®Î≤ï Ï†ú4Ï°∞)
"""

    def _get_labor_law_template(self) -> str:
        """ÎÖ∏ÎèôÎ≤ï ÌÖúÌîåÎ¶ø"""
        return """
## ÎÖ∏ÎèôÎ≤ï ÌäπÌôî ÏßÄÏπ®
- **ÌïµÏã¨ Î∂ÑÏïº**: Í∑ºÎ°úÍ≥ÑÏïΩ, ÏûÑÍ∏à, Í∑ºÎ°úÏãúÍ∞Ñ, Ìú¥Í∞Ä
- **Ï£ºÏöî Î≤ïÎ†π**: Í∑ºÎ°úÍ∏∞Ï§ÄÎ≤ï, ÎÖ∏ÎèôÏ°∞Ìï©Î≤ï, Í≥†Ïö©Î≥¥ÌóòÎ≤ï
- **ÏµúÏã† Í∞úÏ†ï**: 2024ÎÖÑ ÎÖ∏ÎèôÎ≤ï Í∞úÏ†ïÏÇ¨Ìï≠

### ÎãµÎ≥Ä Íµ¨Ï°∞
1. **Î≤ïÏ†Å Í∑ºÍ±∞**: Í∑ºÎ°úÍ∏∞Ï§ÄÎ≤ï Îì± Í¥ÄÎ†® Ï°∞Ìï≠
2. **Ï†àÏ∞® Î∞è Î∞©Î≤ï**: Í∂åÎ¶¨ Íµ¨Ï†ú Ï†àÏ∞®
3. **Íµ¨Ï†ú Í∏∞Í¥Ä**: ÎÖ∏ÎèôÏúÑÏõêÌöå, Î≤ïÏõêÏùò Ïó≠Ìï†
4. **Ïã§Î¨¥ Í∂åÏû•ÏÇ¨Ìï≠**: Ïã§Ï†ú Ï†ÅÏö© Ïãú Í≥†Î†§ÏÇ¨Ìï≠

### ÌäπÎ≥Ñ Í≥†Î†§ÏÇ¨Ìï≠
- Í∑ºÎ°úÍ≥ÑÏïΩÏùò ÏÑ±Î¶Ω (Í∑ºÎ°úÍ∏∞Ï§ÄÎ≤ï Ï†ú15Ï°∞)
- ÏûÑÍ∏àÏùò ÏßÄÍ∏â (Í∑ºÎ°úÍ∏∞Ï§ÄÎ≤ï Ï†ú43Ï°∞ Ïù¥Ìïò)
- Í∑ºÎ°úÏãúÍ∞ÑÏùò Ï†úÌïú (Í∑ºÎ°úÍ∏∞Ï§ÄÎ≤ï Ï†ú50Ï°∞ Ïù¥Ìïò)
- Ìï¥Í≥†Ïùò Ï†úÌïú (Í∑ºÎ°úÍ∏∞Ï§ÄÎ≤ï Ï†ú23Ï°∞)
"""

    def _get_property_law_template(self) -> str:
        """Î∂ÄÎèôÏÇ∞Î≤ï ÌÖúÌîåÎ¶ø"""
        return """
## Î∂ÄÎèôÏÇ∞Î≤ï ÌäπÌôî ÏßÄÏπ®
- **ÌïµÏã¨ Î∂ÑÏïº**: Î∂ÄÎèôÏÇ∞ Í≥ÑÏïΩ, Îì±Í∏∞, Í∂åÎ¶¨Î≥¥Ìò∏
- **Ï£ºÏöî Î≤ïÎ†π**: Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï, Î∂ÄÎèôÏÇ∞ Ïã§Í∂åÎ¶¨ÏûêÎ™ÖÏùò Îì±Í∏∞Ïóê Í¥ÄÌïú Î≤ïÎ•†
- **ÏµúÏã† Í∞úÏ†ï**: 2024ÎÖÑ Î∂ÄÎèôÏÇ∞Î≤ï Í∞úÏ†ïÏÇ¨Ìï≠

### ÎãµÎ≥Ä Íµ¨Ï°∞
1. **Í≥ÑÏïΩ ÏöîÍ±¥**: Î∂ÄÎèôÏÇ∞ Í≥ÑÏïΩÏùò ÏÑ±Î¶ΩÏöîÍ±¥
2. **Îì±Í∏∞ Ï†àÏ∞®**: ÏÜåÏú†Í∂å Ïù¥Ï†Ñ Îì±Í∏∞ Ï†àÏ∞®
3. **Í∂åÎ¶¨ Î≥¥Ìò∏**: ÏÜåÏú†Í∂åÍ≥º Îã¥Î≥¥Í∂åÏùò Î≥¥Ìò∏
4. **Ïã§Î¨¥ Ï£ºÏùòÏÇ¨Ìï≠**: Ïã§Ï†ú Í±∞Îûò Ïãú Í≥†Î†§ÏÇ¨Ìï≠

### ÌäπÎ≥Ñ Í≥†Î†§ÏÇ¨Ìï≠
- Î∂ÄÎèôÏÇ∞ Îß§Îß§Í≥ÑÏïΩÏùò ÏÑ±Î¶Ω (ÎØºÎ≤ï Ï†ú565Ï°∞)
- ÏÜåÏú†Í∂å Ïù¥Ï†ÑÎì±Í∏∞ (Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï Ï†ú98Ï°∞)
- Îã¥Î≥¥Í∂åÏùò ÏÑ§Ï†ï (ÎØºÎ≤ï Ï†ú357Ï°∞ Ïù¥Ìïò)
- Ïã§Í∂åÎ¶¨ÏûêÎ™ÖÏùò Îì±Í∏∞ (Î∂ÄÎèôÏÇ∞ Ïã§Í∂åÎ¶¨ÏûêÎ™ÖÏùò Îì±Í∏∞Ïóê Í¥ÄÌïú Î≤ïÎ•†)
"""

    def _get_intellectual_property_template(self) -> str:
        """ÏßÄÏ†ÅÏû¨ÏÇ∞Í∂åÎ≤ï ÌÖúÌîåÎ¶ø"""
        return """
## ÏßÄÏ†ÅÏû¨ÏÇ∞Í∂åÎ≤ï ÌäπÌôî ÏßÄÏπ®
- **ÌïµÏã¨ Î∂ÑÏïº**: ÌäπÌóà, ÏÉÅÌëú, Ï†ÄÏûëÍ∂å, ÎîîÏûêÏù∏
- **Ï£ºÏöî Î≤ïÎ†π**: ÌäπÌóàÎ≤ï, ÏÉÅÌëúÎ≤ï, Ï†ÄÏûëÍ∂åÎ≤ï, ÎîîÏûêÏù∏Î≥¥Ìò∏Î≤ï
- **ÏµúÏã† Í∞úÏ†ï**: 2024ÎÖÑ ÏßÄÏ†ÅÏû¨ÏÇ∞Í∂åÎ≤ï Í∞úÏ†ïÏÇ¨Ìï≠

### ÎãµÎ≥Ä Íµ¨Ï°∞
1. **Í∂åÎ¶¨ ÎÇ¥Ïö©**: ÏßÄÏ†ÅÏû¨ÏÇ∞Í∂åÏùò ÎÇ¥Ïö©Í≥º Î≤îÏúÑ
2. **Ïπ®Ìï¥ Íµ¨Ï†ú**: Í∂åÎ¶¨ Ïπ®Ìï¥ Ïãú Íµ¨Ï†ú Î∞©Î≤ï
3. **Îì±Î°ù Ï†àÏ∞®**: Í∂åÎ¶¨ Îì±Î°ù Ï†àÏ∞®
4. **Ïã§Î¨¥ Í≥†Î†§ÏÇ¨Ìï≠**: Ïã§Ï†ú Ï†ÅÏö© Ïãú Í≥†Î†§ÏÇ¨Ìï≠

### ÌäπÎ≥Ñ Í≥†Î†§ÏÇ¨Ìï≠
- ÌäπÌóàÏùò ÏÑ±Î¶ΩÏöîÍ±¥ (ÌäπÌóàÎ≤ï Ï†ú2Ï°∞)
- ÏÉÅÌëúÏùò Îì±Î°ùÏöîÍ±¥ (ÏÉÅÌëúÎ≤ï Ï†ú6Ï°∞)
- Ï†ÄÏûëÍ∂åÏùò Î≥¥Ìò∏ (Ï†ÄÏûëÍ∂åÎ≤ï Ï†ú1Ï°∞)
- ÎîîÏûêÏù∏Ïùò Î≥¥Ìò∏ (ÎîîÏûêÏù∏Î≥¥Ìò∏Î≤ï Ï†ú1Ï°∞)
"""

    def _get_tax_law_template(self) -> str:
        """ÏÑ∏Î≤ï ÌÖúÌîåÎ¶ø"""
        return """
## ÏÑ∏Î≤ï ÌäπÌôî ÏßÄÏπ®
- **ÌïµÏã¨ Î∂ÑÏïº**: ÏÜåÎìùÏÑ∏, Î≤ïÏù∏ÏÑ∏, Î∂ÄÍ∞ÄÍ∞ÄÏπòÏÑ∏
- **Ï£ºÏöî Î≤ïÎ†π**: ÏÜåÎìùÏÑ∏Î≤ï, Î≤ïÏù∏ÏÑ∏Î≤ï, Î∂ÄÍ∞ÄÍ∞ÄÏπòÏÑ∏Î≤ï
- **ÏµúÏã† Í∞úÏ†ï**: 2024ÎÖÑ ÏÑ∏Î≤ï Í∞úÏ†ïÏÇ¨Ìï≠

### ÎãµÎ≥Ä Íµ¨Ï°∞
1. **ÏÑ∏Î≤ï Í∑ºÍ±∞**: Í¥ÄÎ†® ÏÑ∏Î≤ï Ï°∞Ìï≠
2. **Í≥ÑÏÇ∞ Î∞©Î≤ï**: ÏÑ∏Ïï° Í≥ÑÏÇ∞ Î∞©Î≤ï
3. **Ïã†Í≥† Ï†àÏ∞®**: ÏÑ∏Í∏à Ïã†Í≥† Ï†àÏ∞®
4. **Ïã§Î¨¥ Ï£ºÏùòÏÇ¨Ìï≠**: Ïã§Ï†ú Ï†ÅÏö© Ïãú Í≥†Î†§ÏÇ¨Ìï≠

### ÌäπÎ≥Ñ Í≥†Î†§ÏÇ¨Ìï≠
- ÏÜåÎìùÏÑ∏Ïùò Í≥ºÏÑ∏ÎåÄÏÉÅ (ÏÜåÎìùÏÑ∏Î≤ï Ï†ú14Ï°∞)
- Î≤ïÏù∏ÏÑ∏Ïùò Í≥ÑÏÇ∞ (Î≤ïÏù∏ÏÑ∏Î≤ï Ï†ú8Ï°∞)
- Î∂ÄÍ∞ÄÍ∞ÄÏπòÏÑ∏Ïùò Í≥ºÏÑ∏ (Î∂ÄÍ∞ÄÍ∞ÄÏπòÏÑ∏Î≤ï Ï†ú1Ï°∞)
- ÏÑ∏Î¨¥Ï°∞ÏÇ¨ÏôÄ Íµ¨Ï†úÏ†àÏ∞® (Íµ≠ÏÑ∏Í∏∞Î≥∏Î≤ï Ï†ú81Ï°∞)
"""

    def _get_civil_procedure_template(self) -> str:
        """ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï ÌÖúÌîåÎ¶ø"""
        return """
## ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï ÌäπÌôî ÏßÄÏπ®
- **ÌïµÏã¨ Î∂ÑÏïº**: ÎØºÏÇ¨ÏÜåÏÜ° Ï†àÏ∞®, Ï¶ùÍ±∞, ÏßëÌñâ
- **Ï£ºÏöî Î≤ïÎ†π**: ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï, ÎØºÏÇ¨ÏßëÌñâÎ≤ï, Í∞ÄÏÇ¨ÏÜåÏÜ°Î≤ï
- **ÏµúÏã† Í∞úÏ†ï**: 2024ÎÖÑ ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï Í∞úÏ†ïÏÇ¨Ìï≠

### ÎãµÎ≥Ä Íµ¨Ï°∞
1. **Í¥ÄÌï† Î≤ïÏõê**: ÏÇ¨Í±¥Ïùò Í¥ÄÌï† Î≤ïÏõê
2. **ÏÜåÏÜ° Ï†àÏ∞®**: ÏÜåÏÜ° Ï†úÍ∏∞Î∂ÄÌÑ∞ ÌåêÍ≤∞ÍπåÏßÄ
3. **Ï¶ùÍ±∞ Ï†úÏ∂ú**: Ï¶ùÍ±∞ ÏàòÏßëÍ≥º Ï†úÏ∂ú Î∞©Î≤ï
4. **Ïã§Î¨¥ Í≥†Î†§ÏÇ¨Ìï≠**: Ïã§Ï†ú ÏÜåÏÜ° ÏßÑÌñâ Ïãú Í≥†Î†§ÏÇ¨Ìï≠

### ÌäπÎ≥Ñ Í≥†Î†§ÏÇ¨Ìï≠
- Î≥¥ÌÜµÏû¨ÌåêÏ†ÅÍ≥º ÌäπÎ≥ÑÏû¨ÌåêÏ†Å (ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï Ï†ú1Ï°∞)
- ÏÜåÏÜ°Ïùò Ï†úÍ∏∞ (ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï Ï†ú248Ï°∞)
- Ï¶ùÍ±∞Ï°∞ÏÇ¨ (ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï Ï†ú288Ï°∞ Ïù¥Ìïò)
- ÌåêÍ≤∞Ïùò Ìö®Î†• (ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï Ï†ú208Ï°∞)
"""

    def _get_criminal_procedure_template(self) -> str:
        """ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï ÌÖúÌîåÎ¶ø"""
        return """
## ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï ÌäπÌôî ÏßÄÏπ®
- **ÌïµÏã¨ Î∂ÑÏïº**: ÌòïÏÇ¨ÏÜåÏÜ° Ï†àÏ∞®, ÏàòÏÇ¨, Ïû¨Ìåê
- **Ï£ºÏöî Î≤ïÎ†π**: ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï, ÏàòÏÇ¨Ï†àÏ∞®Î≤ï
- **ÏµúÏã† Í∞úÏ†ï**: 2024ÎÖÑ ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï Í∞úÏ†ïÏÇ¨Ìï≠

### ÎãµÎ≥Ä Íµ¨Ï°∞
1. **ÏàòÏÇ¨ Ï†àÏ∞®**: ÏàòÏÇ¨ Í∞úÏãúÎ∂ÄÌÑ∞ Í∏∞ÏÜåÍπåÏßÄ
2. **Ïû¨Ìåê Ï†àÏ∞®**: Í≥µÌåê Ï†àÏ∞®ÏôÄ Ï¶ùÍ±∞Ï°∞ÏÇ¨
3. **Íµ¨Ï†ú Î∞©Î≤ï**: Ìï≠ÏÜå, ÏÉÅÍ≥†, Ïû¨Ïã¨
4. **Ïã§Î¨¥ Í≥†Î†§ÏÇ¨Ìï≠**: Ïã§Ï†ú ÏÜåÏÜ° ÏßÑÌñâ Ïãú Í≥†Î†§ÏÇ¨Ìï≠

### ÌäπÎ≥Ñ Í≥†Î†§ÏÇ¨Ìï≠
- ÏàòÏÇ¨Ïùò Í∞úÏãú (ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï Ï†ú195Ï°∞)
- Í∏∞ÏÜåÏùò Ï°∞Í±¥ (ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï Ï†ú247Ï°∞)
- Í≥µÌåêÏ†àÏ∞® (ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï Ï†ú275Ï°∞ Ïù¥Ìïò)
- Ï¶ùÍ±∞Îä•Î†•Í≥º Ï¶ùÎ™ÖÎ†• (ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï Ï†ú307Ï°∞ Ïù¥Ìïò)
"""

    # ÏßàÎ¨∏ Ïú†ÌòïÎ≥Ñ ÌÖúÌîåÎ¶øÎì§
    def _get_precedent_search_template(self) -> str:
        """ÌåêÎ°Ä Í≤ÄÏÉâ ÌÖúÌîåÎ¶ø"""
        return """ÎãπÏã†ÏùÄ ÌåêÎ°Ä Ï†ÑÎ¨∏Í∞ÄÏûÖÎãàÎã§. 

Í¥ÄÎ†® ÌåêÎ°Ä:
{precedent_list}

ÏúÑ ÌåêÎ°ÄÎ•º Î∞îÌÉïÏúºÎ°ú Îã§ÏùåÍ≥º Í∞ôÏù¥ ÎãµÎ≥ÄÌïòÏÑ∏Ïöî:
1. Í∞ÄÏû• Ïú†ÏÇ¨Ìïú ÌåêÎ°Ä 3Í∞ú ÏÜåÍ∞ú (ÏÇ¨Í±¥Î≤àÌò∏, ÌåêÍ≤∞ÏöîÏßÄ)
2. Ìï¥Îãπ ÏÇ¨ÏïàÏóêÏùò Ï†ÅÏö© Í∞ÄÎä•ÏÑ±
3. Ïã§Î¨¥Ï†Å ÏãúÏÇ¨Ï†ê

ÎãµÎ≥ÄÏùÄ Ï†ÑÎ¨∏Ï†ÅÏù¥Î©¥ÏÑúÎèÑ Ïù¥Ìï¥ÌïòÍ∏∞ ÏâΩÍ≤å ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî."""

    def _get_law_inquiry_template(self) -> str:
        """Î≤ïÎ•† Î¨∏Ïùò ÌÖúÌîåÎ¶ø"""
        return """ÎãπÏã†ÏùÄ Î≤ïÎ•† Ìï¥ÏÑ§ Ï†ÑÎ¨∏Í∞ÄÏûÖÎãàÎã§.

Í¥ÄÎ†® Î≤ïÎ•†:
{law_articles}

ÏúÑ Î≤ïÎ•†ÏùÑ Îã§Ïùå ÏàúÏÑúÎ°ú ÏÑ§Î™ÖÌïòÏÑ∏Ïöî:
1. Î≤ïÎ•†Ïùò Î™©Ï†Å Î∞è Ï∑®ÏßÄ
2. Ï£ºÏöî ÎÇ¥Ïö©ÏùÑ Ïâ¨Ïö¥ ÎßêÎ°ú ÌíÄÏù¥
3. Ïã§Ï†ú Ï†ÅÏö© ÏòàÏãú
4. Ï£ºÏùòÏÇ¨Ìï≠

ÎãµÎ≥ÄÏùÄ Ï†ïÌôïÌïòÍ≥† Ïù¥Ìï¥ÌïòÍ∏∞ ÏâΩÍ≤å ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî."""

    def _get_legal_advice_template(self) -> str:
        """Î≤ïÎ•† ÏÉÅÎã¥ ÌÖúÌîåÎ¶ø"""
        return """ÎãπÏã†ÏùÄ Î≤ïÎ•† ÏÉÅÎã¥ Ï†ÑÎ¨∏Í∞ÄÏûÖÎãàÎã§.

Í¥ÄÎ†® Î≤ïÎ•† Î∞è ÌåêÎ°Ä:
{context}

Îã§Ïùå Íµ¨Ï°∞Î°ú Ï°∞Ïñ∏ÌïòÏÑ∏Ïöî:
1. ÏÉÅÌô© Ï†ïÎ¶¨
2. Ï†ÅÏö© Í∞ÄÎä•Ìïú Î≤ïÎ•† (Ï°∞Î¨∏ Î™ÖÏãú)
3. Í¥ÄÎ†® ÌåêÎ°Ä (ÌïµÏã¨ ÌåêÍ≤∞ÏöîÏßÄ)
4. Í∂åÎ¶¨ Íµ¨Ï†ú Î∞©Î≤ï (Îã®Í≥ÑÎ≥Ñ)
5. ÌïÑÏöîÌïú Ï¶ùÍ±∞ ÏûêÎ£å

Ï£ºÏùò: Ïù¥Îäî ÏùºÎ∞òÏ†ÅÏù∏ Î≤ïÎ•† Ï†ïÎ≥¥ Ï†úÍ≥µÏù¥Î©∞, Íµ¨Ï≤¥Ï†ÅÏù∏ ÏÇ¨ÏïàÏùÄ Î≥ÄÌò∏ÏÇ¨ÏôÄ ÏÉÅÎã¥ÌïòÏãúÍ∏∞ Î∞îÎûçÎãàÎã§."""

    def _get_procedure_guide_template(self) -> str:
        """Ï†àÏ∞® ÏïàÎÇ¥ ÌÖúÌîåÎ¶ø"""
        return """ÎãπÏã†ÏùÄ Î≤ïÎ•† Ï†àÏ∞® ÏïàÎÇ¥ Ï†ÑÎ¨∏Í∞ÄÏûÖÎãàÎã§.

Í¥ÄÎ†® Ï†àÏ∞® Ï†ïÎ≥¥:
{procedure_info}

Îã§Ïùå ÏàúÏÑúÎ°ú ÏïàÎÇ¥ÌïòÏÑ∏Ïöî:
1. Ï†àÏ∞® Í∞úÏöî
2. ÌïÑÏöîÌïú ÏÑúÎ•ò Î∞è Ï§ÄÎπÑÏÇ¨Ìï≠
3. Ïã†Ï≤≠ Î∞©Î≤ï Î∞è Ï†àÏ∞®
4. Ï≤òÎ¶¨ Í∏∞Í∞Ñ Î∞è ÎπÑÏö©
5. Ï£ºÏùòÏÇ¨Ìï≠ Î∞è ÌåÅ

Ïã§Ïö©Ï†ÅÏù¥Í≥† Íµ¨Ï≤¥Ï†ÅÏù∏ ÏïàÎÇ¥Î•º Ï†úÍ≥µÌï¥Ï£ºÏÑ∏Ïöî."""

    def _get_term_explanation_template(self) -> str:
        """Ïö©Ïñ¥ Ìï¥ÏÑ§ ÌÖúÌîåÎ¶ø"""
        return """ÎãπÏã†ÏùÄ Î≤ïÎ•† Ïö©Ïñ¥ Ìï¥ÏÑ§ Ï†ÑÎ¨∏Í∞ÄÏûÖÎãàÎã§.

Ïö©Ïñ¥ Ï†ïÎ≥¥:
{term_info}

Îã§Ïùå ÏàúÏÑúÎ°ú ÏÑ§Î™ÖÌïòÏÑ∏Ïöî:
1. Ïö©Ïñ¥Ïùò Ï†ïÏùò
2. Î≤ïÏ†Å Í∑ºÍ±∞ (Í¥ÄÎ†® Ï°∞Î¨∏)
3. Ïã§Ï†ú Ï†ÅÏö© ÏÇ¨Î°Ä
4. Í¥ÄÎ†® Ïö©Ïñ¥ÏôÄÏùò Ï∞®Ïù¥Ï†ê
5. Ïã§Î¨¥ÏóêÏÑúÏùò Ï§ëÏöîÏÑ±

Ï†ïÌôïÌïòÍ≥† Î™ÖÌôïÌïú ÏÑ§Î™ÖÏùÑ Ï†úÍ≥µÌï¥Ï£ºÏÑ∏Ïöî."""

    def _get_general_question_template(self) -> str:
        """ÏùºÎ∞ò ÏßàÎ¨∏ ÌÖúÌîåÎ¶ø"""
        return """ÎãπÏã†ÏùÄ Î≤ïÎ•† Ï†ïÎ≥¥ Ï†úÍ≥µ Ï†ÑÎ¨∏Í∞ÄÏûÖÎãàÎã§.

Í¥ÄÎ†® Ï†ïÎ≥¥:
{general_context}

Îã§Ïùå ÏõêÏπôÏóê Îî∞Îùº ÎãµÎ≥ÄÌïòÏÑ∏Ïöî:
1. ÏßàÎ¨∏Ïóê ÎåÄÌïú Ï†ïÌôïÌïú ÎãµÎ≥Ä Ï†úÍ≥µ
2. Í¥ÄÎ†® Î≤ïÎ•† Î∞è ÌåêÎ°Ä Ïù∏Ïö©
3. Ïù¥Ìï¥ÌïòÍ∏∞ Ïâ¨Ïö¥ ÏÑ§Î™Ö
4. ÌïÑÏöîÌïú Í≤ΩÏö∞ Ï∂îÍ∞Ä Ï†ïÎ≥¥ ÏïàÎÇ¥

Ï†ÑÎ¨∏Ï†ÅÏù¥Î©¥ÏÑúÎèÑ ÏπúÍ∑ºÌïú ÌÜ§ÏúºÎ°ú ÎãµÎ≥ÄÌï¥Ï£ºÏÑ∏Ïöî."""

    def update_prompt_version(self, version: str, content: str, description: str = "") -> bool:
        """ÌîÑÎ°¨ÌîÑÌä∏ Î≤ÑÏ†Ñ ÏóÖÎç∞Ïù¥Ìä∏"""
        try:
            prompt_data = {
                "version": version,
                "content": content,
                "description": description,
                "created_at": datetime.now().isoformat(),
                "created_by": "unified_prompt_manager"
            }
            
            version_file = self.prompts_dir / f"{version}.json"
            with open(version_file, 'w', encoding='utf-8') as f:
                json.dump(prompt_data, f, ensure_ascii=False, indent=2)
            
            logger.info(f"Prompt version {version} updated successfully")
            return True
            
        except Exception as e:
            logger.error(f"Failed to update prompt version {version}: {e}")
            return False

    def get_prompt_analytics(self) -> Dict[str, Any]:
        """ÌîÑÎ°¨ÌîÑÌä∏ ÏÇ¨Ïö© Î∂ÑÏÑù Ï†ïÎ≥¥"""
        try:
            analytics = {
                "total_domains": len(self.domain_templates),
                "total_question_types": len(self.question_type_templates),
                "total_models": len(self.model_optimizations),
                "base_prompts": list(self.base_prompts.keys()),
                "domains": [domain.value for domain in self.domain_templates.keys()],
                "question_types": [qtype.value for qtype in self.question_type_templates.keys()],
                "models": [model.value for model in self.model_optimizations.keys()]
            }
            return analytics
        except Exception as e:
            logger.error(f"Failed to get prompt analytics: {e}")
            return {}


# Ï†ÑÏó≠ Ïù∏Ïä§ÌÑ¥Ïä§
unified_prompt_manager = UnifiedPromptManager()
